
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>15. 트레이딩 전략을 위한 기술적 지표</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "hyunyulhenry/quant_python");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="16. 백테스팅 시뮬레이션" href="16_backtest.html" />
    <link rel="prev" title="14. 포트폴리오 구성 전략" href="14_portfolio.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   파이썬을 이용한 퀀트 투자 포트폴리오 만들기
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01_data_programming.html">
   1. 퀀트 투자의 심장: 데이터와 프로그래밍
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_information.html">
   2. 크롤링을 위한 기본 지식
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_api.html">
   3. API를 이용한 데이터 수집
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_crawl.html">
   4. 크롤링 이해하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_crawl_practice.html">
   5. 금융 데이터 수집하기 (기본)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06_crawl_actual.html">
   6. 금융 데이터 수집하기 (심화)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07_hts_api.html">
   7. 증권사 API 연결 및 매매
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08_us_data.html">
   8. 미국 주식 데이터 수집하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09_other_data.html">
   9. 투자 참고용 데이터 수집하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_bind_data.html">
   10. 데이터 정리하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11_data_analysis.html">
   11. 데이터 분석 및 시각화하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12_factor_basic.html">
   12. 퀀트 전략을 이용한 종목선정 (기본)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13_factor_advanced.html">
   13. 퀀트 전략을 이용한 종목선정 (심화)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14_portfolio.html">
   14. 포트폴리오 구성 전략
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   15. 트레이딩 전략을 위한 기술적 지표
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16_backtest.html">
   16. 백테스팅 시뮬레이션
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/15_trading.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/hyunyulhenry/quant_python/master?urlpath=tree/15_trading.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ta-lib">
   15.1 TA-Lib 패키지 설치하기
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   15.2 이동평균
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     15.2.1 이동평균 계산하기
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rsi">
   15.3 상대강도지수(RSI)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     15.3.1 RSI 계산하기
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   15.4 볼린저밴드
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     15.4.1 볼린저밴드 계산하기
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="id1">
<h1>15. 트레이딩 전략을 위한 기술적 지표<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>이번 장에서는 트레이딩 전략에 대해 알아보도록 하겠습니다. 앞서 종목을 선정하는데 있어 사용되었던 것이 ‘기본적 분석’이라면, 트레이딩은 과거 주가의 움직임이나 패턴을 통해 주식이 오를지 혹은 내릴지를 판단하는 ‘기술적 분석’에 의존하는 경우가 많으며, 이러한 판단을 위해 사용되는 것이 기술적 지표입니다. 기술적 지표는 크게 3가지로 나눌 수 있습니다.</p>
<ol class="simple">
<li><p>트렌드 지표: 추세의 방향이나 강도를 측정하는 지표로써, 대표적으로 <strong>이동평균(Moving Average)</strong> 등이 사용됩니다.</p></li>
<li><p>모멘텀 지표: 가격 움직임의 속도를 측정하는 지표로써, <strong>상대강도지수(Relative Strength Index)</strong> 등이 사용됩니다.</p></li>
<li><p>변동성 지표: 가격 움직임의 정도를 측정하는 지표로써, <strong>볼린저밴드(Bollinger Bands)</strong> 등이 사용됩니다.</p></li>
</ol>
<p>실제로는 셀 수 없을 정도로 많은 종류의 기술적 지표들이 존재합니다. 그러나 이러한 지표들을 맹신해 이를 가지고만 투자하는 것은 매우 위험합니다. 인터넷이나 방송을 보면 과거의 주식 차트와 기술적 지표를 비교하면서, ‘매수 신호가 발생한 후 지속 상승하여 수익을 거둘 수 있다’며 기술적 지표들을 마치 투자의 절대 법칙인것 처럼 말합니다. 그러나 이러한 지표들은 맞는 때도 있지만 틀리는 때도 수도 없이 많으며, 그들은 이러한 예시를 절대로 보여주지 않습니다. 물론 자산군 단위에서는 기술적 지표가 비교적 잘 맞으므로, 시장 타이밍을 잡을 때는 이를 참고하는 것도 도움이 됩니다.</p>
<p>기술적 지표를 이용한 트레이딩 전략은 크게 <strong>추세추종전략</strong>과 <strong>평균회귀전략</strong>으로 나눌 수 있습니다.</p>
<ol class="simple">
<li><p>추세추종 전략: 주가가 동일한 방향으로 지속될 것이라는데 베팅하며, 이동평균 등의 지표가 사용됩니다.</p></li>
<li><p>평균회귀 전략: 주가가 평균으로 다시 회귀하는데 베팅하며, RSI, 볼린저밴드 등의 지표가 사용됩니다.</p></li>
</ol>
<p>이번 장에서는 대표적으로 유명한 지표들을 계산하는 방법에 대해 알아보도록 하겠으며, 이러한 지표를 이용한 트레이딩 전략의 실제 효용성에 대해서는 나중 장에서 다시 살펴보도록 하겠습니다.</p>
<div class="section" id="ta-lib">
<h2>15.1 TA-Lib 패키지 설치하기<a class="headerlink" href="#ta-lib" title="Permalink to this headline">¶</a></h2>
<p>각 기술적 지표를 계산하는 수식이 존재하기에 이를 이용해 계산할 수도 있지만, 패키지를 이용한 경우 매우 손쉽게 계산할 수 있습니다. 그 중에서도 기술적 지표 계산에 사용되는 대표적인 패키지는 <strong>TA-Lib</strong> 입니다. 150개 이상의 지표를 계산할 수 있으며, C로 작성되어 있기에 그 속도 또한 매우 빠릅니다. 리눅스 사용자의 경우 보통의 패키지를 설치하는 것과 동일한 방법으로 손쉽게 설치가 가능합니다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">ta</span><span class="o">-</span><span class="n">lib</span>
</pre></div>
</div>
<p>그러나 윈도우 사용자의 경우 컴파일러가 설치되어 있지 않다면 위 방법을 이용할 시 오류가 발생합니다.</p>
<div class="figure align-default" id="trading-ins-error">
<img alt="_images/trading_ins_error.png" src="_images/trading_ins_error.png" />
<p class="caption"><span class="caption-number">Fig. 69 </span><span class="caption-text">윈도우에서 TA-Lib 설치시 오류 화면</span><a class="headerlink" href="#trading-ins-error" title="Permalink to this image">¶</a></p>
</div>
<p>다행히 캘리포니아 대학교 어바인 캠퍼스에서 컴파일러가 없이도 파이썬 라이브러리를 설치할 수 있도록 미리 컴파일된 파이썬 패키지를 제공합니다. 먼저 본인의 파이썬 버젼 및 윈도우 환경을 확인합니다. 프롬프트에서 파이썬에 접속하면 해당 내역이 출력되며, 파이썬 3.8.5 버젼에 윈도우는 64 비트 환경임이 확인됩니다.</p>
<div class="figure align-default" id="trading-version">
<img alt="_images/trading_version.png" src="_images/trading_version.png" />
<p class="caption"><span class="caption-number">Fig. 70 </span><span class="caption-text">파이썬 및 윈도우 환경 확인</span><a class="headerlink" href="#trading-version" title="Permalink to this image">¶</a></p>
</div>
<p>그 후 아래의 사이트에서 본인의 버젼에 맞는 파일을 다운로드 합니다. (본인의 버젼은 책과 다를 수 있습니다.)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">lfd</span><span class="o">.</span><span class="n">uci</span><span class="o">.</span><span class="n">edu</span><span class="o">/~</span><span class="n">gohlke</span><span class="o">/</span><span class="n">pythonlibs</span><span class="o">/</span><span class="c1">#ta-lib</span>
</pre></div>
</div>
<div class="figure align-default" id="trading-download">
<img alt="_images/trading_download.png" src="_images/trading_download.png" />
<p class="caption"><span class="caption-number">Fig. 71 </span><span class="caption-text">컴파일 패키지 다운로드</span><a class="headerlink" href="#trading-download" title="Permalink to this image">¶</a></p>
</div>
<p>마지막으로 프롬프트에서 다운로드 받은 파일이 있는 폴더로 디렉토리를 변경한 후, 아래와 같이 설치합니다. (폴더 내에 다운로드 받은 파일이 있어야 합니다.)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">파일이</span> <span class="n">있는</span> <span class="n">폴더</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">TA_Lib</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">19</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">win_amd64</span><span class="o">.</span><span class="n">whl</span>
</pre></div>
</div>
<p>TA-Lib 패키지에서 계산할 수 있는 기술적 지표는 아래 사이트에 자세히 나와있습니다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">ta</span><span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">function</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h2>15.2 이동평균<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>트렌드 지표 중 가장 대표적인 이동평균을 계산하는 법에 대해 알아보겠습니다. 이동평균은 정해진 기간동안 주식의 평균 가격입니다. 예를 들어 10일간의 이동평균은, 최근 10일간 가격의 평균을 의미합니다. 이 기간이 길수록 장기간의 추세를 나타내며, 짧을수록 단기간의 추세를 나타냅니다. 이동평균은 현재의 추세나 추세 역전, 혹은 저항 수준을 확인할 때 사용됩니다. 흔히 이동평균이 상승하는 상황에서 주가가 그보다 위에 있다면 상승 신호로 여겨집니다. 반대로 이동평균이 하락하는 상황에서 주가가 그보다 아래에 있다면 하락 신호로 여겨집니다.</p>
<p>또한 골든크로스와 데드크로스라는 말을 많이 들어보셨을 겁니다. 골든크로스란 단기 이동평균선이 중장기 이동평균선을 아래에서 위로 뚫고 올라가는 현상으로써 강세신호를 나타내며, 반대로 데드크로스는 단기 이동평균선이 중장기 이동평균선을 위에서 아래로 뚫고 내려가는 현상으로써 약세신호를 나타냅니다.</p>
<div class="figure align-default" id="trading-cross">
<img alt="_images/trading_cross.png" src="_images/trading_cross.png" />
<p class="caption"><span class="caption-number">Fig. 72 </span><span class="caption-text">골든크로스와 데드크로스</span><a class="headerlink" href="#trading-cross" title="Permalink to this image">¶</a></p>
</div>
<p>이동평균을 계산하는 방법은 가격 데이터에 가중치를 얼마나 두냐에 따라 여러가지 방법이 존재하지만, 크게 단순 이동평균과 지수 이동평균이 사용됩니다.</p>
<ul class="simple">
<li><p>단순 이동평균(SMA, Simple Moving Average): 이동평균을 계산할 때 사용되는 가장 일반적인 방법으로써, 단순히 주어진 기간 동안의 종가의 평균을 구합니다.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[SMA_n = (P_1 + P_2 + \dots + P_n) / n\]</div>
<ul class="simple">
<li><p>지수 이동평균(EMA, Exponential Moving Average): 최근 데이터가 더욱 중요할 수 있으며, 지수 이동평균은 이를 반영하여 각 데이터에 가중치를 다르게 부여한 후 평균을 구합니다.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[EMA_n = P_n \times 승수 + 이전\ EMA \times (1-승수)\]</div>
<div class="math notranslate nohighlight">
\[승수 = 2/(n+1)\]</div>
<div class="section" id="id3">
<h3>15.2.1 이동평균 계산하기<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>TA-lib 패키지를 이용해 단순 이동평균과 지수 이동평균을 구해보도록 하겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">web</span>

<span class="n">stock_data</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s1">&#39;^GSPC&#39;</span><span class="p">,</span> <span class="s1">&#39;yahoo&#39;</span><span class="p">)</span>
<span class="n">stock_data</span> <span class="o">=</span> <span class="n">stock_data</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>먼저 S&amp;P 500 지수(^GSPC) 데이터를 다운로드 받은 후, 최근 500일 데이터만 선택합니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">talib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">stock_data</span><span class="p">[</span><span class="s1">&#39;SMA_20&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">SMA</span><span class="p">(</span><span class="n">stock_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span> <span class="c1"># 20일 단순 이동평균</span>
<span class="n">stock_data</span><span class="p">[</span><span class="s1">&#39;SMA_60&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">SMA</span><span class="p">(</span><span class="n">stock_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span> <span class="o">=</span> <span class="mi">60</span><span class="p">)</span> <span class="c1"># 60일 단순 이동평균</span>
<span class="n">stock_data</span><span class="p">[[</span><span class="s1">&#39;Close&#39;</span><span class="p">,</span> <span class="s1">&#39;SMA_20&#39;</span><span class="p">,</span> <span class="s1">&#39;SMA_60&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/15_trading_10_0.png" src="_images/15_trading_10_0.png" />
</div>
</div>
<ol class="simple">
<li><p>talib 패키지의 <code class="docutils literal notranslate"><span class="pre">SMA()</span></code> 함수를 이용하면 손쉽게 단순 이동평균을 계산할 수 있습니다. 주가에 해당하는 열을 입력한 후, timeperiod에는 얼마의 기간에 해당하는 평균을 계산할지를 입력합니다.</p></li>
<li><p>종가, 20일 이동평균, 60일 이동평균에 해당하는 값을 그래프로 나타냅니다.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stock_data</span><span class="p">[</span><span class="s1">&#39;EMA_60&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">EMA</span><span class="p">(</span><span class="n">stock_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span> <span class="mi">60</span><span class="p">)</span> <span class="c1"># 60일 지수 이동평균</span>
<span class="n">stock_data</span><span class="p">[[</span><span class="s1">&#39;Close&#39;</span><span class="p">,</span> <span class="s1">&#39;SMA_60&#39;</span><span class="p">,</span> <span class="s1">&#39;EMA_60&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/15_trading_12_0.png" src="_images/15_trading_12_0.png" />
</div>
</div>
<p>지수 이동평균 역시 <code class="docutils literal notranslate"><span class="pre">EMA()</span></code> 함수를 통해 쉽게 계산할 수 있습니다. 60일 이동평균을 출력해보면, 지수 이동평균이 최근 데이터에 더 많은 가중치를 부여하기에, 단순 이동평균보다 주가의 움직임에 따라 더욱 민감하게 반응하는 것을 알 수 있습니다.</p>
</div>
</div>
<div class="section" id="rsi">
<h2>15.3 상대강도지수(RSI)<a class="headerlink" href="#rsi" title="Permalink to this headline">¶</a></h2>
<p>이번에는 모멘텀 지표 중 대표적인 RSI에 대해 알아보겠습니다. RSI는 일정기간 동안 주가의 상승폭과 하락폭의 크기를 비교해 상승과 하락의 상대적인 강도를 나타낸 지표로써, 다음과 같이 계산됩니다.</p>
<ol class="simple">
<li><p>U(Up): 가격이 상승한 날의 상승폭</p></li>
<li><p>D(Down): 가격이 하락한 날의 하락폭</p></li>
<li><p>AU(Average Up)과 AD(Average Down): U값과 D값의 평균을 각각 구함</p></li>
<li><p>RS(Relative Strenth): AU/AD를 통해 상대강도를 구함</p></li>
</ol>
<p>RS 값이 크다는 것은 일정기간 동안 상승한 폭이 하락한 폭보다 크다는 것을 의미하며, RSI는 0에서 100 범위 내에서 움직입니다. 일반적으로 RSI가 70 이상일 경우 과매수 구간으로써 매도할 때를, 30 이하일 경우 과매도 구간으로써 매수해야 할 때로 여겨집니다. 즉 지나친 상승 뒤에는 하락할 것을, 지나친 하락 뒤에는 상승할 것을 기대합니다.</p>
<div class="figure align-default" id="trading-rsi">
<img alt="_images/trading_rsi.png" src="_images/trading_rsi.png" />
<p class="caption"><span class="caption-number">Fig. 73 </span><span class="caption-text">RSI 지표</span><a class="headerlink" href="#trading-rsi" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="id4">
<h3>15.3.1 RSI 계산하기<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">gridspec</span>

<span class="n">stock_data</span><span class="p">[</span><span class="s1">&#39;RSI_14&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">RSI</span><span class="p">(</span><span class="n">stock_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">stock_data</span><span class="p">[</span><span class="s1">&#39;RSI_14&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># 주가 나타내기</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">stock_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>

<span class="c1"># RSI 나타내기</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">stock_data</span><span class="p">[</span><span class="s1">&#39;RSI_14&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hspace</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/15_trading_17_0.png" src="_images/15_trading_17_0.png" />
</div>
</div>
<ol class="simple">
<li><p>talib 패키지의 <code class="docutils literal notranslate"><span class="pre">RSI()</span></code> 함수를 이용해 RSI를 계산할 수 있으며, timeperiod는 기간을 의미합니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GridSpec()</span></code> 함수를 통해 그림을 두 구간으로 나누어 줍니다.</p></li>
<li><p>상단에는 주가를 나타냅니다.</p></li>
<li><p>하단에는 RSI 및 과매수와 과매도를 의미하는 70과 30 부분에 수평선을 그려줍니다.</p></li>
<li><p>두 그림 간 빈칸을 0으로 설정합니다.</p></li>
</ol>
<p>RSI 신호에 따라 매매하는 것이 맞을때도 있지만 그렇지 않을때도 있습니다.</p>
</div>
</div>
<div class="section" id="id5">
<h2>15.4 볼린저밴드<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>볼린저밴드는 이동평균선을 중심으로 일정 표준편차를 상한선과 하한선으로 설정한 밴드입니다.</p>
<ul class="simple">
<li><p>중심 밴드: n 기간 동안의 이동평균</p></li>
<li><p>상단 밴드: 중심 밴드 기준 k 표준편차 위</p></li>
<li><p>하단 밴드: 중심 밴드 기준 k 표준편차 아래</p></li>
</ul>
<div class="figure align-default" id="trading-bb">
<img alt="_images/trading_bb.png" src="_images/trading_bb.png" />
<p class="caption"><span class="caption-number">Fig. 74 </span><span class="caption-text">볼린저밴드</span><a class="headerlink" href="#trading-bb" title="Permalink to this image">¶</a></p>
</div>
<p>이는 주가의 움직임이 정규분포를 따른다는 가정에 기초합니다. 정규분포에서는 데이터가 1 표준편차 내에 있을 확률이 약 68%, 2 표준편차 내에 있을 확률이 약 95%, 3 표준편차 내에 있을 확률이 약 99% 입니다. 만일 주가가 정규분포를 따른다면, 주가의 움직임은 상한선과 하한선으로 구성된 밴드 내에서만 움직일 확률이 높습니다. 따라서 주가가 상한선 위에 있다는 것은 과매수 상태이므로 하락할 가능성이, 하단선 아래에 있다는 것은 과매도 상태이므로 상승할 가능성이 높습니다.</p>
<div class="figure align-default" id="trading-norm">
<img alt="_images/trading_norm.png" src="_images/trading_norm.png" />
<p class="caption"><span class="caption-number">Fig. 75 </span><span class="caption-text">정규분포에 따른 확률</span><a class="headerlink" href="#trading-norm" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="id6">
<h3>15.4.1 볼린저밴드 계산하기<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">upper_2sd</span><span class="p">,</span> <span class="n">mid_2sd</span><span class="p">,</span> <span class="n">lower_2sd</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">BBANDS</span><span class="p">(</span><span class="n">stock_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span>
                                             <span class="n">nbdevup</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                                             <span class="n">nbdevdn</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                                             <span class="n">timeperiod</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">bb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">upper_2sd</span><span class="p">,</span> <span class="n">mid_2sd</span><span class="p">,</span> <span class="n">lower_2sd</span><span class="p">,</span> <span class="n">stock_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">bb</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Upper Band&#39;</span><span class="p">,</span> <span class="s1">&#39;Mid Band&#39;</span><span class="p">,</span> <span class="s1">&#39;Lower Band&#39;</span><span class="p">,</span> <span class="s1">&#39;Close&#39;</span><span class="p">]</span>
<span class="n">bb</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Upper Band&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;Lower Band&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;Mid Band&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;Close&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/15_trading_22_0.png" src="_images/15_trading_22_0.png" />
</div>
</div>
<ol class="simple">
<li><p>talib 패키지의 <code class="docutils literal notranslate"><span class="pre">BBANDS()</span></code> 함수를 이용해 볼린저 밴드의 상, 중, 하단 값을 계산한 후 각각의 변수에 저장합니다. nbdevup와 nbdevdn는 각각 상단과 하단 밴드를 몇 표준편차 기준으로 계산할지를 의미하며, timeperiod는 이동평균에 계산되는 최근 일수를 의미합니다.</p></li>
<li><p>볼린저밴드 값과 종가를 <code class="docutils literal notranslate"><span class="pre">concat()</span></code> 함수를 이용해 하나의 데이터프레임으로 합칩니다.</p></li>
<li><p>그래프로 나타내줍니다.</p></li>
</ol>
<p>주가가 크게 움직이지 않는 한 2 표준편차로 계산된 밴드 내에서 주가가 움직이는 것이 확인됩니다.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="14_portfolio.html" title="previous page">14. 포트폴리오 구성 전략</a>
    <a class='right-next' id="next-link" href="16_backtest.html" title="next page">16. 백테스팅 시뮬레이션</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By 이현열<br/>
        
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>