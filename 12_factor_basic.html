
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>12. 퀀트 전략을 이용한 종목선정 (기본)</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "hyunyulhenry/quant_python");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="13. 퀀트 전략을 이용한 종목선정 (심화)" href="13_factor_advanced.html" />
    <link rel="prev" title="11. 데이터 분석 및 시각화하기" href="11_data_analysis.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   파이썬을 이용한 퀀트 투자 포트폴리오 만들기
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01_data_programming.html">
   1. 퀀트 투자의 심장: 데이터와 프로그래밍
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_information.html">
   2. 크롤링을 위한 기본 지식
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_api.html">
   3. API를 이용한 데이터 수집
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_crawl.html">
   4. 크롤링 이해하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_crawl_practice.html">
   5. 금융 데이터 수집하기 (기본)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06_crawl_actual.html">
   6. 금융 데이터 수집하기 (심화)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07_hts_api.html">
   7. 증권사 API 연결 및 매매
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08_us_data.html">
   8. 미국 주식 데이터 수집하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09_other_data.html">
   9. 투자 참고용 데이터 수집하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_bind_data.html">
   10. 데이터 정리하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11_data_analysis.html">
   11. 데이터 분석 및 시각화하기
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   12. 퀀트 전략을 이용한 종목선정 (기본)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13_factor_advanced.html">
   13. 퀀트 전략을 이용한 종목선정 (심화)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14_portfolio.html">
   14. 포트폴리오 구성 전략
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15_trading.html">
   15. 트레이딩 전략을 위한 기술적 지표
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16_backtest.html">
   16. 백테스팅 시뮬레이션
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/12_factor_basic.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/hyunyulhenry/quant_python/master?urlpath=tree/12_factor_basic.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   12.1 베타 이해하기
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     12.1.1 베타 계산하기
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     12.1.2 베타 시각화
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   12.2 저변동성 전략
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     12.2.1 변동성 별 누적 수익률
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     12.2.2 저변동성 포트폴리오 구하기: 일간 기준
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     12.2.3 저변동성 포트폴리오 구하기: 주간 기준
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id9">
   12.3 모멘텀 전략
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     12.3.1 모멘텀 별 누적 수익률
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#datareader">
       12.3.1.1
       <code class="docutils literal notranslate">
        <span class="pre">
         DataReader()
        </span>
       </code>
       함수를 이용한 팩터 데이터 다운로드
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       12.3.1.2 단기 모멘텀
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id12">
       12.3.1.2 중기 모멘텀
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       12.3.1.3 장기 모멘텀
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     12.3.2 모멘텀 포트폴리오 구하기: 12개월 모멘텀
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id15">
     12.3.3 모멘텀 포트폴리오 구하기: 위험조정 수익률
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#k-ratio">
     12.3.4 K-Ratio
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id16">
   12.4 밸류 전략
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id17">
     12.4.1 가치지표 별 누적 수익률
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pbr">
     12.4.2 밸류 포트폴리오 구하기: 저PBR
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id18">
     12.4.3 각 지표 결합하기
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id19">
   12.5 퀄리티 전략
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#f-score">
     12.5.1 F-Score
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id21">
     12.5.2 수익성 지표 결합하기
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="id1">
<h1>12. 퀀트 전략을 이용한 종목선정 (기본)<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>투자에 필요한 주가, 재무제표, 가치지표 데이터가 준비되었다면 퀀트 전략을 활용해 투자하고자 하는 종목을 선정해야 합니다. 퀀트 투자는 크게 포트폴리오 운용 전략과 트레이딩 전략으로 나눌 수 있습니다. 포트폴리오 운용 전략은 과거 주식 시장을 분석해 좋은 주식의 기준을 찾아낸 후 해당 기준에 만족하는 종목을 매수하거나, 이와 반대에 있는 나쁜 주식을 공매도하기도 합니다. 투자의 속도가 느리며, 다수의 종목을 하나의 포트폴리오로 구성해 운용하는 특징이 있습니다. 반면 트레이딩 전략은 주식이 오르거나 내리는 움직임을 연구한 후 각종 지표를 이용해 매수 혹은 매도하는 전략입니다. 투자의 속도가 빠르며 소수의 종목을 대상으로 합니다. 본 책에서는 퀀트 전략을 이용한 종목선정 및 구성 전략에 대해 먼저 살펴본 후, 트레이딩 전략에 대해 살펴보도록 하겠습니다.</p>
<table class="colwidths-auto table" id="quant-type">
<caption><span class="caption-number">Table 7 </span><span class="caption-text">퀀트 투자 종류의 비교</span><a class="headerlink" href="#quant-type" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>기준</p></th>
<th class="head"><p>포트폴리오 운용 전략</p></th>
<th class="head"><p>트레이딩 전략</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>투자철학</p></td>
<td><p>규칙에 기반한 투자</p></td>
<td><p>규칙에 기반한 투자</p></td>
</tr>
<tr class="row-odd"><td><p>투자목적</p></td>
<td><p>좋은 주식을 매수</p></td>
<td><p>좋은 시점을 매수</p></td>
</tr>
<tr class="row-even"><td><p>학문적 기반</p></td>
<td><p>경제학, 통계학 등</p></td>
<td><p>통계학, 공학, 정보처리 등</p></td>
</tr>
<tr class="row-odd"><td><p>투자의 속도</p></td>
<td><p>느림</p></td>
<td><p>빠름</p></td>
</tr>
</tbody>
</table>
<p>주식의 수익률에 영향을 미치는 요소를 팩터(Factor)라고 합니다. 즉 팩터의 강도가 양인 종목들로 구성한 포트폴리오는 향후 수익률이 높을 것으로 예상되며, 팩터의 강도가 음인 종목들로 구성한 포트폴리오는 반대로 향후 수익률이 낮을 것으로 예상됩니다.</p>
<p>팩터에 대한 연구는 학자들에 의해 오랫동안 진행되어 왔지만, 일반 투자자들이 이러한 논문을 모두 찾아보고 연구하기는 사실상 불가능에 가깝습니다. 그러나 최근에는 스마트베타라는 이름으로 팩터 투자가 대중화되고 있습니다. 최근 유행하고 있는 스마트베타 ETF는 팩터를 기준으로 포트폴리오를 구성한 상품으로서, 학계나 실무에서 검증된 팩터 전략을 기반으로 합니다.</p>
<p>해당 상품들의 웹사이트나 투자설명서에는 종목 선정 기준에 대해 자세히 나와 있으므로 스마트베타 ETF에 나와 있는 투자 전략을 자세히 분석하는 것만으로도 훌륭한 퀀트 투자 전략을 만들 수 있습니다.</p>
<div class="figure align-default" id="factor-smartbeta">
<img alt="_images/factor_smartbeta.png" src="_images/factor_smartbeta.png" />
<p class="caption"><span class="caption-number">Fig. 63 </span><span class="caption-text">스마트베타 ETF 전략 예시</span><a class="headerlink" href="#factor-smartbeta" title="Permalink to this image">¶</a></p>
</div>
<p>이번 장에서는 투자에 많이 활용되는 기본적인 팩터에 대해 알아보고, 우리가 구한 데이터를 바탕으로 각 팩터별 투자 종목을 선택하는 방법을 알아보겠습니다.</p>
<div class="section" id="id2">
<h2>12.1 베타 이해하기<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>투자자들이라면 누구나 한 번은 베타(Beta)라는 용어를 들어봤을 것입니다. 기본적으로 주식시장의 움직임은 개별 주식의 수익률에 가장 크게 영향을 주는 요소일 수밖에 없습니다. 아무리 좋은 주식도 주식시장이 폭락한다면 같이 떨어지며, 아무리 나쁜 주식도 주식시장이 상승한다면 대부분 같이 오르기 마련입니다.</p>
<p>개별 주식이 전체 주식시장의 변동에 반응하는 정도를 나타낸 값이 베타입니다. 베타가 1이라는 뜻은 주식시장과 움직임이 정확히 같다는 뜻으로서 시장 그 자체를 나타냅니다. 베타가 1.5라는 뜻은 주식시장이 수익률이 +1%일 때 개별 주식의 수익률은 +1.5% 움직이며, 반대로 주식시장의 수익률이 -1%일 때 개별 주식의 수익률은 -1.5% 움직인다는 뜻입니다. 반면 베타가 0.5라면 주식시장 수익률의 절반 정도만 움직이게 됩니다.</p>
<table class="colwidths-auto table" id="beta">
<caption><span class="caption-number">Table 8 </span><span class="caption-text">베타에 따른 개별 주식의 수익률 움직임</span><a class="headerlink" href="#beta" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>베타</p></th>
<th class="head"><p>주식시장이 +1% 일 경우</p></th>
<th class="head"><p>주식시장이 -1% 일 경우</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.5</p></td>
<td><p>+0.5%</p></td>
<td><p>-0.5%</p></td>
</tr>
<tr class="row-odd"><td><p>1.0</p></td>
<td><p>+1.0%</p></td>
<td><p>-1.0%</p></td>
</tr>
<tr class="row-even"><td><p>1.5</p></td>
<td><p>+1.5%</p></td>
<td><p>-1.5%</p></td>
</tr>
</tbody>
</table>
<p>이처럼 베타가 큰 주식은 주식시장보다 수익률의 움직임이 크며, 반대로 베타가 낮은 주식은 주식시장보다 수익률의 움직임이 작습니다. 따라서 일반적으로 상승장이 기대될 때는 베타가 큰 주식에, 하락장이 기대될 때는 베타가 낮은 주식에 투자하는 것이 좋습니다.
주식시장에서 베타는 통계학의 회귀분석모형에서 기울기를 나타내는 베타와 정확히 의미가 같습니다. 회귀분석모형은 <span class="math notranslate nohighlight">\(y = a + bx\)</span> 형태로 나타나며, 회귀계수인 <span class="math notranslate nohighlight">\(b\)</span>는 <span class="math notranslate nohighlight">\(x\)</span>의 변화에 따른 <span class="math notranslate nohighlight">\(y\)</span>의 변화의 기울기입니다. 이를 주식에 적용한 모형이 자산가격결정모형(CAPM: Capital Asset Pricing Model)(Sharpe 1964)이며, 그 식은 다음과 같습니다.</p>
<div class="math notranslate nohighlight">
\[회귀분석모형:\ y = a + bx\]</div>
<div class="math notranslate nohighlight">
\[자산가격결정모형: R_i = R_f + \beta_i \times [R_m - R_f]\]</div>
<p>먼저 회귀분석모형의 상수항인 <span class="math notranslate nohighlight">\(a\)</span>에 해당하는 부분은 무위험 수익률을 나타내는 <span class="math notranslate nohighlight">\(R_f\)</span>입니다. 독립변수인 <span class="math notranslate nohighlight">\(x\)</span>에 해당하는 부분은 무위험 수익률 대비 주식 시장의 초과 수익률을 나타내는 시장위험 프리미엄인 <span class="math notranslate nohighlight">\(R_m - R_f\)</span>입니다. 종속변수인 <span class="math notranslate nohighlight">\(y\)</span>에 해당하는 부분은 개별주식의 수익률을 나타내는 <span class="math notranslate nohighlight">\(R_i\)</span>이며, 최종적으로 회귀계수인 <span class="math notranslate nohighlight">\(b\)</span>에 해당하는 부분은 개별 주식의 베타입니다.</p>
<table class="colwidths-auto table" id="beta-formulta">
<caption><span class="caption-number">Table 9 </span><span class="caption-text">회귀분석모형과 자산가격결정모형의 비교</span><a class="headerlink" href="#beta-formulta" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>구분</p></th>
<th class="head"><p>회귀분석모형</p></th>
<th class="head"><p>자산가격결정모형</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>상수항</p></td>
<td><p>a</p></td>
<td><p><span class="math notranslate nohighlight">\(R_f\)</span> (무위험수익률)</p></td>
</tr>
<tr class="row-odd"><td><p>독립변수</p></td>
<td><p>x</p></td>
<td><p><span class="math notranslate nohighlight">\(R_m - R_f\)</span> (시장위험 프리미엄)</p></td>
</tr>
<tr class="row-even"><td><p>종속변수</p></td>
<td><p>y</p></td>
<td><p><span class="math notranslate nohighlight">\(R_i\)</span> (개별주식의 수익률)</p></td>
</tr>
<tr class="row-odd"><td><p>회귀계수</p></td>
<td><p>b</p></td>
<td><p><span class="math notranslate nohighlight">\(\beta_i\)</span> (개별주식의 베타)</p></td>
</tr>
</tbody>
</table>
<p>통계학에서 회귀계수는 <span class="math notranslate nohighlight">\(\beta = \frac{cov(x,y)}{\sigma_x^2}\)</span> 형태로 구할 수 있으며, <span class="math notranslate nohighlight">\(x\)</span>와 <span class="math notranslate nohighlight">\(y\)</span>에 각각 시장수익률과 개별주식의 수익률을 대입할 경우 개별주식의 베타는 <span class="math notranslate nohighlight">\(\beta_i= \rho(i,m) \times\frac{\sigma_i}{\sigma_m}\)</span> 형태로 구할 수 있습니다. 그러나 이러한 수식을 모르더라도 파이썬에서는 간단히 베타를 구할 수 있습니다.</p>
<div class="section" id="id3">
<h3>12.1.1 베타 계산하기<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>베타를 구하는 방법을 알아보기 위해 주식시장에 대한 대용치로 KOSPI 200 ETF, 개별주식으로는 전통적 고베타주인 증권주를 이용하겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">web</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">tickers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;102110.KS&#39;</span><span class="p">,</span> <span class="s1">&#39;039490.KS&#39;</span><span class="p">]</span>

<span class="n">all_data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">ticker</span> <span class="ow">in</span> <span class="n">tickers</span><span class="p">:</span>
    <span class="n">all_data</span><span class="p">[</span><span class="n">ticker</span><span class="p">]</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="n">ticker</span><span class="p">,</span> <span class="s1">&#39;yahoo&#39;</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2016-01-01&quot;</span><span class="p">)</span>
    
<span class="n">prices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">tic</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">tic</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">all_data</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
<span class="n">ret</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>    
<span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2016-01-01&#39;</span><span class="p">:</span><span class="s1">&#39;2020-12-31&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>KOSPI 200 ETF인 TIGER 200(102110.KS), 증권주인 키움증권(039490.KS)의 티커를 입력합니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataReader()</span></code> 함수를 이용하여 해당 티커들의 데이터를 다운로드 받습니다.</p></li>
<li><p>종가만을 선택한 후, 데이터프레임 형태로 만들어줍니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pct_change()</span></code> 함수를 통해 수익률을 계산한 후, NA 데이터는 삭제합니다.</p></li>
<li><p>2016년 1월 1일부터 2020년 12월 31일까지의 데이터만 선택합니다.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="n">rm</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ri</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">reg</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">rm</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">reg</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>        <td>039490.KS</td>    <th>  R-squared (uncentered):</th>      <td>   0.354</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared (uncentered):</th> <td>   0.354</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th>          <td>   668.3</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Wed, 14 Apr 2021</td> <th>  Prob (F-statistic):</th>          <td>7.75e-118</td>
</tr>
<tr>
  <th>Time:</th>                 <td>14:32:57</td>     <th>  Log-Likelihood:    </th>          <td>  3020.8</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>  1219</td>      <th>  AIC:               </th>          <td>  -6040.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>  1218</td>      <th>  BIC:               </th>          <td>  -6034.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>              <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>              <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>102110.KS</th> <td>    1.3665</td> <td>    0.053</td> <td>   25.852</td> <td> 0.000</td> <td>    1.263</td> <td>    1.470</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>151.608</td> <th>  Durbin-Watson:     </th> <td>   2.189</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td> 332.513</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.726</td>  <th>  Prob(JB):          </th> <td>6.25e-73</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.106</td>  <th>  Cond. No.          </th> <td>    1.00</td>
</tr>
</table><br/><br/>Notes:<br/>[1] R² is computed without centering (uncentered) since the model does not contain a constant.<br/>[2] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>102110.KS    1.366499
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>증권주를 대상으로 베타를 구하기 위한 회귀분석을 실시합니다. 자산가격결정모형의 수식인 <span class="math notranslate nohighlight">\(R_i = R_f + \beta_i \times [R_m - R_f]\)</span> 에서 편의를 위해 무위험 수익률인 <span class="math notranslate nohighlight">\(R_f\)</span>를 0으로 가정하면, <span class="math notranslate nohighlight">\(R_i = \beta_i \times R_m\)</span>의 형태로 나타낼 수 있습니다. 이 중 <span class="math notranslate nohighlight">\(R_m\)</span>는 독립변수인 주식시장의 수익률을 의미하고, <span class="math notranslate nohighlight">\(R_i\)</span>는 종속변수인 개별 주식의 수익률을 의미합니다.</p>
<ol class="simple">
<li><p>독립변수는 첫 번째 열인 KOSPI 200 ETF의 수익률을 선택하며, 종속변수는 두번째 열인 증권주의 수익률을 선택합니다.</p></li>
<li><p>statsmodels 패키지의 <code class="docutils literal notranslate"><span class="pre">OLS()</span></code> 함수를 통해 손쉽게 선형회귀분석을 실시할 수 있으며, 회귀분석의 결과를 reg 변수에 저장합니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">summary()</span></code> 함수는 데이터의 요약 정보를 나타내며, 해당 예시에서는 회귀분석 결과에 대한 정보를 보여줍니다.</p></li>
</ol>
<p>회귀분석의 결과 중 가장 중요한 부분은 베타를 나타내는 coef입니다. 베타값이 매우 높아 증권주의 특성인 고베타주임이 확인되며, t값 또한 2 보다 커 매우 유의한 결과입니다.</p>
</div>
<div class="section" id="id4">
<h3>12.1.2 베타 시각화<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>이제 구해진 베타를 그림으로 표현해보겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rm</span><span class="p">,</span> <span class="n">ri</span><span class="p">)</span> <span class="c1"># 원 데이터 산포도</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rm</span><span class="p">,</span> <span class="n">rm</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Beta = 1&#39;</span><span class="p">)</span> <span class="c1"># beta = 1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rm</span><span class="p">,</span> <span class="n">reg</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Regression line&#39;</span><span class="p">)</span> <span class="c1"># 회귀직선</span>
 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;KOSPI 200&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Individual Stock&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/12_factor_basic_13_0.png" src="_images/12_factor_basic_13_0.png" />
</div>
</div>
<ol class="simple">
<li><p>시장 수익률과 개별주식 수익률을 <code class="docutils literal notranslate"><span class="pre">scatter()</span></code> 함수를 이용해 산포도로 그려줍니다.</p></li>
<li><p>시장 수익률에 해당하는 부분(Beta = 1)을 검은색 점선으로 그려줍니다.</p></li>
<li><p>추정된 회귀식(Regression line)을 붉은색 선으로 그려줍니다.</p></li>
<li><p>라벨 및 범례를 입력합니다.</p></li>
</ol>
<p>검은색의 점선이 기울기가 1인 경우이며, 주황색의 직선이 증권주의 회귀분석결과를 나타냅니다. 기울기가 1보다 훨씬 가파름이 확인되며, 즉 베타가 1보다 크다는 사실을 알 수 있습니다.</p>
</div>
</div>
<div class="section" id="id5">
<h2>12.2 저변동성 전략<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>금융 시장에서 변동성은 수익률이 움직이는 정도로서, 일반적으로 표준편차가 사용됩니다. 표준편차는 자료가 평균을 중심으로 얼마나 퍼져 있는지를 나타내는 수치로서, 수식은 다음과 같습니다.</p>
<div class="math notranslate nohighlight">
\[\sigma = \sqrt{\frac{\sum_{i=1}^{n}{(x_i - \bar{x})^2}}{n-1}}\]</div>
<p>관측값의 개수가 적을 경우에는 수식에 대입해 계산하는 것이 가능하지만, 관측값이 수백 혹은 수천 개로 늘어날 경우 컴퓨터를 이용하지 않고 계산하기는 사실상 불가능합니다. 파이썬에서는 복잡한 계산 과정 없이 <code class="docutils literal notranslate"><span class="pre">stdev()</span></code> 함수를 이용해 간단하게 표준편차를 계산할 수 있습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statistics</span> <span class="kn">import</span> <span class="n">stdev</span> 

<span class="n">example</span> <span class="o">=</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">72</span><span class="p">]</span>
<span class="n">stdev</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.357238094391549
</pre></div>
</div>
</div>
</div>
<p>개별 주식의 표준편차를 측정할 때는 주식의 가격이 아닌 수익률로 계산해야 합니다. 수익률의 표준편차가 크면 수익률이 위아래로 많이 움직여 위험한 종목으로 여겨집니다. 반면 표준편차가 작으면 수익률의 움직임이 적어 상대적으로 안전한 종목으로 여겨집니다.</p>
<p>전통적 금융 이론에서는 수익률의 변동성이 클수록 위험이 크고, 이런 위험에 대한 보상으로 기대수익률이 높아야 한다고 보았습니다. 따라서 고변동성 종목의 기대수익률이 크고, 저변동성 종목의 기대수익률이 낮은 고위험 고수익이 당연한 믿음이었습니다. 그러나 현실에서는 오히려 변동성이 낮은 종목들의 수익률이 변동성이 높은 종목들의 수익률보다 높은, 저변동성 효과가 발견되고 있습니다. 이러한 저변동성 효과가 발생하는 원인으로는 여러 가설이 있습니다.</p>
<ol class="simple">
<li><p>투자자들은 대체로 자신의 능력을 과신하는 경향이 있으며, 복권과 같이 큰 수익을 가져다 주는 고변동성 주식을 선호하는 경향이 있습니다. 이러한 결과로 고변동성 주식은 과대 평가되어 수익률이 낮은 반면, 과소 평가된 저변동성 주식들은 높은 수익률을 보이게 됩니다. (Brunnermeier and Parker 2005)</p></li>
<li><p>대부분 기관투자가들이 레버리지 투자가 되지 않는 상황에서, 벤치마크 대비 높은 성과를 얻기 위해 고변동성 주식에 투자하는 경향이 있으며, 이 또한 고변동성 주식이 과대 평가되는 결과로 이어집니다. (Baker, Bradley, and Wurgler 2011)</p></li>
<li><p>시장의 상승과 하락이 반복됨에 따라 고변동성 주식이 변동성 손실(Volatility Drag)로 인해 수익률이 하락하게 되는 이유도 있습니다. (Sefton et al. 2011)</p></li>
</ol>
<p>변동성이 크다는 것은 크게 벌 가능성도 있지만, 반대로 크게 잃을 가능성도 존재합니다. 큰 손실을 복구하기 위해서는 더욱 큰 수익률을 기록해야 합니다. 예를 들어 10,000원 에서 50%의 손실을 본다면 5,000원이 되지만, 원금이 되기 위해서는 50%가 아닌 100% 수익을 거두어야 합니다.</p>
<p><a class="reference internal" href="#factor-voldrag"><span class="std std-numref">Fig. 64</span></a>는 변동성이 각각 5%, 10%, 15%, 20%, 25% 인 주식이 상승과 하락을 반복하는 경우를 시뮬레이션 한 것입니다. 변동성이 클수록 처음 상승시점에서 상승폭은 크지만, 다음 하락시점에서 원금 대비 하락폭 또한 큽니다. 이처럼 상승과 하락이 반복될 경우 변동성의 비대칭으로 인해 장기적으로 변동성이 작은 주식의 수익률이 더 높게 됩니다.</p>
<div class="figure align-default" id="factor-voldrag">
<img alt="_images/factor_voldrag.png" src="_images/factor_voldrag.png" />
<p class="caption"><span class="caption-number">Fig. 64 </span><span class="caption-text">각 변동성에 따른 누적 수익률 그래프</span><a class="headerlink" href="#factor-voldrag" title="Permalink to this image">¶</a></p>
</div>
<p>주식의 위험은 변동성뿐만 아니라 베타 등 여러 지표로도 측정할 수 있습니다. 저변동성 효과와 비슷하게 고유변동성이 낮은 주식의 수익률이 높은 저고유변동성(Ang et al. 2009)효과, 베타가 낮은 주식의 수익률이 오히려 높은 저베타 효과(Baker, Bradley, and Taliaferro 2014)도 발견되고 있으며, 이러한 효과들을 합쳐 저위험 효과라고 부르기도 합니다.</p>
<div class="section" id="id6">
<h3>12.2.1 변동성 별 누적 수익률<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>유럽의 퀀트 기반 자산운용사인 Robeco에서는 1929년부터 변동성에 따라 구성된 포트폴리오의 역사적 수익률을 제공하고 있습니다. 이를 통해 정말로 저변동성 포트폴리오가 고변동성 포트폴리오보다 우수한 성과를 보였는지 확인해보도록 하겠습니다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">robeco</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">en</span><span class="o">/</span><span class="n">insights</span><span class="o">/</span><span class="mi">2019</span><span class="o">/</span><span class="mi">01</span><span class="o">/</span><span class="n">data</span><span class="o">-</span><span class="n">sets</span><span class="o">-</span><span class="n">volatility</span><span class="o">-</span><span class="nb">sorted</span><span class="o">-</span><span class="n">portfolios</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
<p>먼저 해당 페이지의 [Download the data]에 위치한 엑셀 데이터를 파이썬에서 불러오도록 하겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://www.robeco.com/docm/docu-robeco-data-sets-volatility-sorted-portfolios.xlsx&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">sheet_name</span> <span class="o">=</span> <span class="s1">&#39;Conservative Formula 2021&#39;</span><span class="p">,</span> <span class="n">skiprows</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">cut_row</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">cut_row</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Date&#39;</span>

<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Low volatility</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>High volatility</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1929-01-31</th>
      <td>0.049068</td>
      <td>0.055891</td>
      <td>0.028393</td>
      <td>0.027992</td>
      <td>0.028601</td>
      <td>0.042569</td>
      <td>0.019569</td>
      <td>0.026325</td>
      <td>0.068246</td>
      <td>-0.015916</td>
    </tr>
    <tr>
      <th>1929-02-28</th>
      <td>0.001052</td>
      <td>-0.004374</td>
      <td>0.001483</td>
      <td>0.010956</td>
      <td>0.026740</td>
      <td>-0.017976</td>
      <td>0.020075</td>
      <td>-0.012382</td>
      <td>0.013717</td>
      <td>0.057899</td>
    </tr>
    <tr>
      <th>1929-03-29</th>
      <td>-0.009444</td>
      <td>-0.010437</td>
      <td>-0.018429</td>
      <td>-0.030655</td>
      <td>-0.026962</td>
      <td>-0.039162</td>
      <td>-0.033466</td>
      <td>-0.052638</td>
      <td>-0.011746</td>
      <td>-0.020680</td>
    </tr>
    <tr>
      <th>1929-04-30</th>
      <td>-0.001644</td>
      <td>0.018043</td>
      <td>0.010668</td>
      <td>0.016756</td>
      <td>-0.003668</td>
      <td>0.045984</td>
      <td>0.019777</td>
      <td>-0.003291</td>
      <td>0.029879</td>
      <td>-0.021943</td>
    </tr>
    <tr>
      <th>1929-05-31</th>
      <td>0.003102</td>
      <td>-0.058104</td>
      <td>-0.052835</td>
      <td>-0.050367</td>
      <td>-0.096969</td>
      <td>-0.066940</td>
      <td>-0.109504</td>
      <td>-0.170854</td>
      <td>-0.142702</td>
      <td>-0.144243</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="simple">
<li><p>해당 url을 입력합니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">read_excel()</span></code> 함수를 통해 엑셀 데이터를 읽어오며, sheet명과 스킵할 행 개수를 입력합니다.</p></li>
<li><p>데이터 하단에는 이를 설명하는 자료이므로, 데이터에 해당하는 테이블이 몇번째 행까지 위치하는지를 알 필요가 있습니다. 모든 열이 NA인 행이 몇번째 인지를 찾아줍니다.</p></li>
<li><p>변동성 별 수익률에 해당하는 첫번째부터 cut_row 행까지를 선택한 후, 인덱스를 날짜에 해당하는 열로 변경합니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">to_numeric()</span></code> 함수를 통해 모든 데이터를 숫자 형태로 변경합니다.</p></li>
<li><p>인덱스의 이름을 변경합니다.</p></li>
</ol>
<p>해당 수익률은 다음과 같이 계산되었습니다. 먼저 과거 36개월 수익률의 변동성을 기준으로 매월 말 10개 포트폴리오로 나눈 후 한달 뒤 각 포트폴리오의 수익률을 계산합니다. 그 후 다시 과거 36개월 기준으로 포트폴리오를 나눈 후 한달 후에 수익률을 계산하며, 이러한 작업을 매월 반복해 나갑니다. Low volatility는 과거 수익률의 변동성이 가장 낮았던 종목들로 이루어진 포트폴리오이며, 숫자가 커질수록 변동성이 점점 더 큰 종목들로 이루어진 포트폴리오 입니다. High volatility는 변동성이 가장 큰 종목들로 이루어진 포트폴리오 입니다. 각 포트폴리오의 평균 수익률을 확인해보도록 하겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/12_factor_basic_23_0.png" src="_images/12_factor_basic_23_0.png" />
</div>
</div>
<p>변동성이 높을수록 수익률 역시 높은 경향이 있지만, 가장 변동성이 높은 ‘High volatility’ 포트폴리오의 수익률은 그렇지 못합니다. 이는 변동성이 지나치게 높은 종목은 상장폐지 등 악재로 이어질 가능성이 높기 때문입니다. 이번에는 복리를 고려한 누적 수익률을 살펴보도록 하겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>

<span class="n">data_cum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">data_cum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">colormap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Volatility&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/12_factor_basic_25_0.png" src="_images/12_factor_basic_25_0.png" />
</div>
</div>
<p>먼저 수익률을 로그수익률로 변환한 후, 누적합을 계산합니다. 변동성 별 포트폴리오의 누적 수익률을 살펴보면, 변동성이 낮은 포트폴리오가 높은 포트폴리오 보다 장기적으로 수익률이 높습니다. 또한 변동성이 지나치게 높은 포트폴리오는 매우 부진한 성과를 보이므로, 이러한 종목들은 피하는 것이 좋습니다.</p>
</div>
<div class="section" id="id7">
<h3>12.2.2 저변동성 포트폴리오 구하기: 일간 기준<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>먼저 최근 1년 일간 수익률 기준 변동성이 낮은 30종목을 선택하겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">statistics</span> <span class="kn">import</span> <span class="n">stdev</span> 

<span class="n">KOR_price</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/KOR_price.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">KOR_ticker</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/KOR_ticker.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">KOR_ticker</span><span class="p">[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KOR_ticker</span><span class="p">[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="n">ret</span> <span class="o">=</span> <span class="n">KOR_price</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
<span class="n">std_12m_daily</span>  <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">252</span><span class="p">:</span> <span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">stdev</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>저장해둔 가격 정보와 티커 정보를 불러옵니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pct_change()</span></code> 함수를 통해 수익률을 구합니다.</p></li>
<li><p>데이터프레임 하단의 252개, 즉 최근 252 일의 데이터를 선택합니다. (주식 시장의 1년 영업일은 대략 252일 입니다). <code class="docutils literal notranslate"><span class="pre">apply()</span></code> 함수를 통해 stdev 즉 변동성을 계산해주며, 연율화를 해주기 위해 <code class="docutils literal notranslate"><span class="pre">sqrt()</span></code> 함수를 통해 <span class="math notranslate nohighlight">\(\sqrt{252}\)</span> 를 곱해줍니다.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">std_12m_daily</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">patches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_fc</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/12_factor_basic_31_0.png" src="_images/12_factor_basic_31_0.png" />
</div>
</div>
<p>변동성을 히스토그램으로 나타내보면, 0 에 위치하는 종목들이 다수 있습니다. 해당 종목들은 최근 1년간 거래정지로 인해 가격이 변하지 않았고, 이로 인해 변동성이 없는 종목들입니다. 해당 종목들은 NA로 처리해줍니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">std_12m_daily</span><span class="p">[</span><span class="n">std_12m_daily</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
</div>
<p>다음으로 일간 수익률 기준 변동성이 낮은 30종목의 변동성을 확인해보겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">invest_lowvol</span> <span class="o">=</span> <span class="p">(</span><span class="n">std_12m_daily</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="nb">print</span><span class="p">(</span><span class="n">std_12m_daily</span><span class="p">[</span><span class="n">invest_lowvol</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>033780    0.213817
030200    0.220826
215600    0.136249
267980    0.207293
001720    0.191573
072710    0.180600
016800    0.118965
000480    0.197399
002960    0.187043
004690    0.191838
002810    0.202861
049180    0.196368
018120    0.130561
015360    0.189513
004890    0.130267
036190    0.196859
004970    0.199972
100250    0.181985
117580    0.141714
005990    0.213116
034590    0.138567
040420    0.144117
007590    0.215019
005190    0.204591
109860    0.202258
004450    0.220137
000850    0.185773
014100    0.156389
084670    0.202722
066790    0.130025
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">height</span> <span class="o">=</span> <span class="n">std_12m_daily</span><span class="p">[</span><span class="n">invest_lowvol</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/12_factor_basic_36_0.png" src="_images/12_factor_basic_36_0.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">rank()</span></code> 함수를 통해 순위를 구할 수 있으며, 파이썬은 기본적으로 오름차순 즉 가장 낮은값의 순위가 1이 됩니다. 따라서 변동성이 낮을수록 높은 순위가 되며, 30위 이하의 순위를 선택하면 변동성이 낮은 30종목이 선택됩니다. 또한 그림을 통해 해당 종목들의 변동성을 확인해볼 수도 있습니다.</p>
<p>이번에는 해당 종목들의 티커 및 종목명을 확인하겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">invest_lowvol_df</span> <span class="o">=</span> <span class="n">KOR_ticker</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">invest_lowvol</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">,</span> <span class="s1">&#39;종목명&#39;</span><span class="p">]]</span>
<span class="n">invest_lowvol_df</span><span class="p">[</span><span class="s1">&#39;변동성&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">std_12m_daily</span><span class="p">[</span><span class="n">invest_lowvol</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="n">invest_lowvol_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목코드</th>
      <th>종목명</th>
      <th>변동성</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31</th>
      <td>033780</td>
      <td>KT&amp;G</td>
      <td>0.2138</td>
    </tr>
    <tr>
      <th>47</th>
      <td>030200</td>
      <td>KT</td>
      <td>0.2208</td>
    </tr>
    <tr>
      <th>287</th>
      <td>215600</td>
      <td>신라젠</td>
      <td>0.1362</td>
    </tr>
    <tr>
      <th>409</th>
      <td>267980</td>
      <td>매일유업</td>
      <td>0.2073</td>
    </tr>
    <tr>
      <th>433</th>
      <td>001720</td>
      <td>신영증권</td>
      <td>0.1916</td>
    </tr>
    <tr>
      <th>616</th>
      <td>072710</td>
      <td>농심홀딩스</td>
      <td>0.1806</td>
    </tr>
    <tr>
      <th>643</th>
      <td>016800</td>
      <td>퍼시스</td>
      <td>0.1190</td>
    </tr>
    <tr>
      <th>651</th>
      <td>000480</td>
      <td>조선내화</td>
      <td>0.1974</td>
    </tr>
    <tr>
      <th>663</th>
      <td>002960</td>
      <td>한국쉘석유</td>
      <td>0.1870</td>
    </tr>
    <tr>
      <th>673</th>
      <td>004690</td>
      <td>삼천리</td>
      <td>0.1918</td>
    </tr>
    <tr>
      <th>748</th>
      <td>002810</td>
      <td>삼영무역</td>
      <td>0.2029</td>
    </tr>
    <tr>
      <th>856</th>
      <td>049180</td>
      <td>셀루메드</td>
      <td>0.1964</td>
    </tr>
    <tr>
      <th>978</th>
      <td>018120</td>
      <td>진로발효</td>
      <td>0.1306</td>
    </tr>
    <tr>
      <th>989</th>
      <td>015360</td>
      <td>예스코홀딩스</td>
      <td>0.1895</td>
    </tr>
    <tr>
      <th>1015</th>
      <td>004890</td>
      <td>동일산업</td>
      <td>0.1303</td>
    </tr>
    <tr>
      <th>1060</th>
      <td>036190</td>
      <td>금화피에스시</td>
      <td>0.1969</td>
    </tr>
    <tr>
      <th>1078</th>
      <td>004970</td>
      <td>신라교역</td>
      <td>0.2000</td>
    </tr>
    <tr>
      <th>1172</th>
      <td>100250</td>
      <td>진양홀딩스</td>
      <td>0.1820</td>
    </tr>
    <tr>
      <th>1208</th>
      <td>117580</td>
      <td>대성에너지</td>
      <td>0.1417</td>
    </tr>
    <tr>
      <th>1342</th>
      <td>005990</td>
      <td>매일홀딩스</td>
      <td>0.2131</td>
    </tr>
    <tr>
      <th>1442</th>
      <td>034590</td>
      <td>인천도시가스</td>
      <td>0.1386</td>
    </tr>
    <tr>
      <th>1545</th>
      <td>040420</td>
      <td>정상제이엘에스</td>
      <td>0.1441</td>
    </tr>
    <tr>
      <th>1588</th>
      <td>007590</td>
      <td>동방아그로</td>
      <td>0.2150</td>
    </tr>
    <tr>
      <th>1628</th>
      <td>005190</td>
      <td>동성화학</td>
      <td>0.2046</td>
    </tr>
    <tr>
      <th>1665</th>
      <td>109860</td>
      <td>동일금속</td>
      <td>0.2023</td>
    </tr>
    <tr>
      <th>1740</th>
      <td>004450</td>
      <td>삼화왕관</td>
      <td>0.2201</td>
    </tr>
    <tr>
      <th>1757</th>
      <td>000850</td>
      <td>화천기공</td>
      <td>0.1858</td>
    </tr>
    <tr>
      <th>1839</th>
      <td>014100</td>
      <td>메디앙스</td>
      <td>0.1564</td>
    </tr>
    <tr>
      <th>1883</th>
      <td>084670</td>
      <td>동양고속</td>
      <td>0.2027</td>
    </tr>
    <tr>
      <th>1961</th>
      <td>066790</td>
      <td>씨씨에스</td>
      <td>0.1300</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>티커와 종목명, 연율화 변동성을 확인할 수 있습니다.</p>
</div>
<div class="section" id="id8">
<h3>12.2.3 저변동성 포트폴리오 구하기: 주간 기준<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>이번에는 일간 변동성이 아닌 주간 변동성을 기준으로 저변동성 종목을 선택하겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">KOR_price</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">KOR_price</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">ret_w</span> <span class="o">=</span> <span class="n">KOR_price</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
<span class="n">std_12m_weekly</span> <span class="o">=</span> <span class="n">ret_w</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">52</span><span class="p">:</span> <span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">stdev</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span>
<span class="n">std_12m_weekly</span><span class="p">[</span><span class="n">std_12m_weekly</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>가격 데이터프레임의 인덱스를 datetime 형태로 변경해줍니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resample()</span></code> 함수를 이용해 주간 데이터로 변경한 후, <code class="docutils literal notranslate"><span class="pre">pct_change()</span></code> 함수를 이용해 수익률을 계산합니다.</p></li>
<li><p>데이터프레임 하단의 52개, 즉 최근 52 주의 데이터를 선택합니다. (주식 시장의 1년 영업일은 대략 52주 입니다). <code class="docutils literal notranslate"><span class="pre">apply()</span></code> 함수를 통해 stdev 즉 변동성을 계산해주며, 연율화를 해주기 위해 <code class="docutils literal notranslate"><span class="pre">sqrt()</span></code> 함수를 통해 <span class="math notranslate nohighlight">\(\sqrt{52}\)</span> 를 곱해줍니다.</p></li>
<li><p>변동성이 0인 종목은 NA로 변경해줍니다.</p></li>
</ol>
<p>이후 과정은 위와 동일합니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">invest_lowvol_weekly</span> <span class="o">=</span> <span class="p">(</span><span class="n">std_12m_weekly</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="n">invest_lowvol_weekly_df</span> <span class="o">=</span> <span class="n">KOR_ticker</span><span class="p">[</span><span class="n">invest_lowvol_weekly</span><span class="p">][[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">,</span> <span class="s1">&#39;종목명&#39;</span><span class="p">]]</span>
<span class="n">invest_lowvol_weekly_df</span><span class="p">[</span><span class="s1">&#39;변동성&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">std_12m_weekly</span><span class="p">[</span><span class="n">invest_lowvol_weekly</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="n">invest_lowvol_weekly_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목코드</th>
      <th>종목명</th>
      <th>변동성</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>148</th>
      <td>007310</td>
      <td>오뚜기</td>
      <td>0.1943</td>
    </tr>
    <tr>
      <th>287</th>
      <td>215600</td>
      <td>신라젠</td>
      <td>0.0669</td>
    </tr>
    <tr>
      <th>409</th>
      <td>267980</td>
      <td>매일유업</td>
      <td>0.1895</td>
    </tr>
    <tr>
      <th>616</th>
      <td>072710</td>
      <td>농심홀딩스</td>
      <td>0.1525</td>
    </tr>
    <tr>
      <th>643</th>
      <td>016800</td>
      <td>퍼시스</td>
      <td>0.0842</td>
    </tr>
    <tr>
      <th>651</th>
      <td>000480</td>
      <td>조선내화</td>
      <td>0.1802</td>
    </tr>
    <tr>
      <th>663</th>
      <td>002960</td>
      <td>한국쉘석유</td>
      <td>0.1778</td>
    </tr>
    <tr>
      <th>978</th>
      <td>018120</td>
      <td>진로발효</td>
      <td>0.1052</td>
    </tr>
    <tr>
      <th>989</th>
      <td>015360</td>
      <td>예스코홀딩스</td>
      <td>0.1489</td>
    </tr>
    <tr>
      <th>1015</th>
      <td>004890</td>
      <td>동일산업</td>
      <td>0.1299</td>
    </tr>
    <tr>
      <th>1060</th>
      <td>036190</td>
      <td>금화피에스시</td>
      <td>0.1699</td>
    </tr>
    <tr>
      <th>1078</th>
      <td>004970</td>
      <td>신라교역</td>
      <td>0.1715</td>
    </tr>
    <tr>
      <th>1170</th>
      <td>282690</td>
      <td>동아타이어</td>
      <td>0.1946</td>
    </tr>
    <tr>
      <th>1172</th>
      <td>100250</td>
      <td>진양홀딩스</td>
      <td>0.1762</td>
    </tr>
    <tr>
      <th>1200</th>
      <td>003460</td>
      <td>유화증권</td>
      <td>0.1846</td>
    </tr>
    <tr>
      <th>1208</th>
      <td>117580</td>
      <td>대성에너지</td>
      <td>0.1344</td>
    </tr>
    <tr>
      <th>1342</th>
      <td>005990</td>
      <td>매일홀딩스</td>
      <td>0.1844</td>
    </tr>
    <tr>
      <th>1442</th>
      <td>034590</td>
      <td>인천도시가스</td>
      <td>0.1017</td>
    </tr>
    <tr>
      <th>1455</th>
      <td>078000</td>
      <td>텔코웨어</td>
      <td>0.1738</td>
    </tr>
    <tr>
      <th>1545</th>
      <td>040420</td>
      <td>정상제이엘에스</td>
      <td>0.1474</td>
    </tr>
    <tr>
      <th>1588</th>
      <td>007590</td>
      <td>동방아그로</td>
      <td>0.1720</td>
    </tr>
    <tr>
      <th>1628</th>
      <td>005190</td>
      <td>동성화학</td>
      <td>0.1548</td>
    </tr>
    <tr>
      <th>1665</th>
      <td>109860</td>
      <td>동일금속</td>
      <td>0.1344</td>
    </tr>
    <tr>
      <th>1729</th>
      <td>196450</td>
      <td>코아시아옵틱스</td>
      <td>0.1657</td>
    </tr>
    <tr>
      <th>1740</th>
      <td>004450</td>
      <td>삼화왕관</td>
      <td>0.1822</td>
    </tr>
    <tr>
      <th>1757</th>
      <td>000850</td>
      <td>화천기공</td>
      <td>0.1854</td>
    </tr>
    <tr>
      <th>1881</th>
      <td>115310</td>
      <td>인포바인</td>
      <td>0.1583</td>
    </tr>
    <tr>
      <th>1961</th>
      <td>066790</td>
      <td>씨씨에스</td>
      <td>0.1492</td>
    </tr>
    <tr>
      <th>2088</th>
      <td>086250</td>
      <td>이노와이즈</td>
      <td>0.1605</td>
    </tr>
    <tr>
      <th>2116</th>
      <td>223310</td>
      <td>경남제약헬스케어</td>
      <td>0.0621</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>주간 수익률의 변동성이 낮은 30종목을 선택해 종목코드, 종목명, 연율화 변동성을 확인합니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">invest_lowvol_df</span><span class="p">[</span><span class="s1">&#39;종목명&#39;</span><span class="p">],</span> <span class="n">invest_lowvol_weekly_df</span><span class="p">[</span><span class="s1">&#39;종목명&#39;</span><span class="p">],</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;inner&#39;</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        종목명
0       신라젠
1      매일유업
2     농심홀딩스
3       퍼시스
4      조선내화
5     한국쉘석유
6      진로발효
7    예스코홀딩스
8      동일산업
9    금화피에스시
10     신라교역
11    진양홀딩스
12    대성에너지
13    매일홀딩스
14   인천도시가스
15  정상제이엘에스
16    동방아그로
17     동성화학
18     동일금속
19     삼화왕관
20     화천기공
21     씨씨에스
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">merge()</span></code> 함수 내에 inner를 통해 일간 변동성 기준과 주간 변동성 기준 모두에 포함되는 종목을 찾을 수 있습니다.</p>
</div>
</div>
<div class="section" id="id9">
<h2>12.3 모멘텀 전략<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>투자에서 모멘텀이란 주가 혹은 이익의 추세로서, 상승 추세의 주식은 지속적으로 상승하며 하락 추세의 주식은 지속적으로 하락하는 현상을 말합니다. 모멘텀의 종류는 크게 기업의 이익에 대한 추세를 나타내는 이익 모멘텀(Rendleman Jr, Jones, and Latane 1982)과 주가의 모멘텀에 대한 가격 모멘텀이 있으며, 이 중에서 3개월에서 12개월 가격 모멘텀을 흔히 모멘텀이라고 합니다. 즉 과거 12개월 수익률이 높았던 종목이 계속해서 상승하는 현상을 모멘텀이라 합니다.</p>
<p>모멘텀 현상이 발생하는 가장 큰 원인은 투자자들의 심리적 편향 때문입니다{cite}(Hurst, Ooi, and Pedersen 2013). 펀더멘털 가치에는 변화가 생겼지만 사람들의 과소반응으로 인해 주가는 서서히 오르게 시작합니다. 그 후 이 추세는 양떼효과로 인한 과잉반응으로 지속적으로 상승하여 펀더멘털을 초과하게 되며, 그 결과 하락 반전으로 이어집니다.</p>
<div class="figure align-default" id="factor-momentum">
<img alt="_images/factor_momentum.png" src="_images/factor_momentum.png" />
<p class="caption"><span class="caption-number">Fig. 65 </span><span class="caption-text">추세의 라이프 사이클</span><a class="headerlink" href="#factor-momentum" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>출처: Hurst, Ooi, and Pedersen (2013)</p>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>계산 기간에 따른 모멘텀의 종류</p>
<ul class="simple">
<li><p>단기 모멘텀: 최근 한 주 혹은 1개월 수익률이 높을(수록) 차월 수익률이 낮은(높은) 현상. 단기 수익률 반전 현상이라고도 함. (Lehmann 1990, Jegadeesh 1990)</p></li>
<li><p>중기 모멘텀: 최근 3-12개월 수익률이 높았던 주식이 향후에도 지속적으로 상승하는 현상. (Jegadeesh and Titman 1993)</p></li>
<li><p>장기 모멘텀: 최근 3-5년 수익률이 낮았던 종목들이, 수익률이 높았던 종목보다 성과가 높은 현상. 장기 수익률 반전 현상이라고도 함. (De Bondt and Thaler 1985)</p></li>
</ul>
</div>
<div class="section" id="id10">
<h3>12.3.1 모멘텀 별 누적 수익률<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>케네스 프렌치 교수의 Data Library에는 각종 팩터에 관한 수익률이 매월 업데이트 되며, 단기/중기/장기 모멘텀 데이터 역시 확인할 수 있습니다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">mba</span><span class="o">.</span><span class="n">tuck</span><span class="o">.</span><span class="n">dartmouth</span><span class="o">.</span><span class="n">edu</span><span class="o">/</span><span class="n">pages</span><span class="o">/</span><span class="n">faculty</span><span class="o">/</span><span class="n">ken</span><span class="o">.</span><span class="n">french</span><span class="o">/</span><span class="n">data_library</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
<p>또한 <code class="docutils literal notranslate"><span class="pre">DataReader()</span></code> 함수에는 해당 사이트의 데이터를 읽어오는 기능이 내장되어, 팩터 데이터를 매우 쉽게 분석할 수 있습니다.</p>
<div class="section" id="datareader">
<h4>12.3.1.1 <code class="docutils literal notranslate"><span class="pre">DataReader()</span></code> 함수를 이용한 팩터 데이터 다운로드<a class="headerlink" href="#datareader" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">DataReader()</span></code> 함수를 이용하면 프렌치 라이브러리의 모든 데이터를 불러올 수 있습니다. 어떠한 항목이 있는지 확인해보도록 하겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas_datareader.data</span> <span class="k">as</span> <span class="nn">web</span>  <span class="c1"># module for reading datasets directly from the web</span>
<span class="kn">from</span> <span class="nn">pandas_datareader.famafrench</span> <span class="kn">import</span> <span class="n">get_available_datasets</span>

<span class="n">datasets</span> <span class="o">=</span> <span class="n">get_available_datasets</span><span class="p">()</span>
<span class="n">datasets</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;F-F_Research_Data_Factors_weekly&#39;,
 &#39;F-F_Research_Data_Factors_daily&#39;,
 &#39;F-F_Research_Data_5_Factors_2x3&#39;,
 &#39;F-F_Research_Data_5_Factors_2x3_daily&#39;,
 &#39;Portfolios_Formed_on_ME&#39;,
 &#39;Portfolios_Formed_on_ME_Wout_Div&#39;,
 &#39;Portfolios_Formed_on_ME_Daily&#39;,
 &#39;Portfolios_Formed_on_BE-ME&#39;,
 &#39;Portfolios_Formed_on_BE-ME_Wout_Div&#39;]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id11">
<h4>12.3.1.2 단기 모멘텀<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h4>
<p>먼저 단기 모멘텀, 즉 최근 1개월 수익률을 기준으로 구성된 포트폴리오의 수익률을 비교해보겠습니다. 프렌치 라이브러리에서 해당 데이터의 이름은 ‘10_Portfolios_Prior_1_0’ 입니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas_datareader.data</span> <span class="k">as</span> <span class="nn">web</span>

<span class="n">df_short</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s1">&#39;10_Portfolios_Prior_1_0&#39;</span><span class="p">,</span> <span class="s1">&#39;famafrench&#39;</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;1900-01-01&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">df_short</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Lo PRIOR</th>
      <th>PRIOR 2</th>
      <th>PRIOR 3</th>
      <th>PRIOR 4</th>
      <th>PRIOR 5</th>
      <th>PRIOR 6</th>
      <th>PRIOR 7</th>
      <th>PRIOR 8</th>
      <th>PRIOR 9</th>
      <th>Hi PRIOR</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1926-02</th>
      <td>-7.81</td>
      <td>-5.00</td>
      <td>-3.97</td>
      <td>-3.74</td>
      <td>-4.75</td>
      <td>-1.32</td>
      <td>-1.79</td>
      <td>-1.51</td>
      <td>-2.60</td>
      <td>-5.29</td>
    </tr>
    <tr>
      <th>1926-03</th>
      <td>-17.24</td>
      <td>-12.06</td>
      <td>-12.10</td>
      <td>-5.31</td>
      <td>-8.53</td>
      <td>-4.50</td>
      <td>-4.73</td>
      <td>-4.91</td>
      <td>-3.29</td>
      <td>-9.56</td>
    </tr>
    <tr>
      <th>1926-04</th>
      <td>1.28</td>
      <td>1.90</td>
      <td>2.13</td>
      <td>5.14</td>
      <td>4.05</td>
      <td>3.64</td>
      <td>4.57</td>
      <td>3.42</td>
      <td>4.24</td>
      <td>3.39</td>
    </tr>
    <tr>
      <th>1926-05</th>
      <td>-3.28</td>
      <td>0.90</td>
      <td>-1.56</td>
      <td>1.06</td>
      <td>1.98</td>
      <td>2.62</td>
      <td>1.45</td>
      <td>0.39</td>
      <td>1.38</td>
      <td>1.22</td>
    </tr>
    <tr>
      <th>1926-06</th>
      <td>7.43</td>
      <td>8.25</td>
      <td>11.65</td>
      <td>5.72</td>
      <td>7.86</td>
      <td>4.71</td>
      <td>4.00</td>
      <td>4.06</td>
      <td>3.55</td>
      <td>3.10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">DataReader()</span></code> 함수 내에 원하는 데이터 명을 입력한 후 데이터 출처인 ‘famafrench’, 시작일자를 입력하면 웹페이지의 데이터가 다운로드 됩니다. 각 딕셔너리에는 시가총액가중, 동일가중, 팩터에 대한 설명이 나와있으므로, 시가총액가중에 해당하는 첫번째 값을 선택합니다. Lo PRIOR는 최근 1개월 수익률이 낮았던 종목들의 포트폴리오이며, 반대로 Hi PRIOR는 수익률이 높았던 종목들의 포트폴리오 입니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>

<span class="n">df_short_cum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">df_short</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">df_short_cum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">colormap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Short Term Return&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/12_factor_basic_59_0.png" src="_images/12_factor_basic_59_0.png" />
</div>
</div>
<p>해당 사이트의 데이터는 1이 1%를 의미하므로, 올바른 계산을 위해 100으로 나누어줍니다. 그 후 로그수익률을 계산한 후 누적값을 구합니다. 누적 수익률을 확인해보면, 최근 1개월 수익률이 낮은 포트폴리오의 수익률이 높은 포트폴리오의 수익률보다 장기적으로 우수한, 단기 수익률 반전 현상이 존재함이 확인됩니다.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>원하는 데이터의 이름을 찾는법은 다음과 같습니다. 먼저 홈페이지에서 원하는 데이터를 찾은 후, [CSV] 글자에서 마우스를 우클릭 해 [링크 주소 복사]를 누릅니다. 단기 모멘텀에 해당하는 <strong>10 Portfolios Formed on Short-Term Reversal</strong> 의 다운로드 링크를 메모장 등에서 확인해보면 다음과 같습니다.</p>
<p>https://mba.tuck.dartmouth.edu/pages/faculty/ken.french/ftp/10_Portfolios_Prior_1_0_CSV.zip</p>
<p>이 중 끝부분의 <strong>10_Portfolios_Prior_1_0_CSV</strong> 에서 <strong>_CSV</strong>를 제외한 글자를 <code class="docutils literal notranslate"><span class="pre">DataReader()</span></code> 함수 내에 입력하면 해당 데이터가 다운로드 됩니다.</p>
<div class="figure align-default" id="french-link">
<img alt="_images/french_link.png" src="_images/french_link.png" />
<p class="caption"><span class="caption-number">Fig. 66 </span><span class="caption-text">링크 주소의 확인</span><a class="headerlink" href="#french-link" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="id12">
<h4>12.3.1.2 중기 모멘텀<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>이번에는 가장 일반적인 모멘텀, 즉 최근 12개월 수익률을 기준으로 구성된 포트폴리오의 수익률을 확인해보겠습니다. 해당 데이터의 이름은 ‘10_Portfolios_Prior_12_2’ 입니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_mom</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s1">&#39;10_Portfolios_Prior_12_2&#39;</span><span class="p">,</span> <span class="s1">&#39;famafrench&#39;</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;1900-01-01&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">df_mom_cum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">df_mom</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">df_mom_cum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">colormap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;12 Month Return&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/12_factor_basic_63_0.png" src="_images/12_factor_basic_63_0.png" />
</div>
</div>
<p>누적수익률을 확인해보면, 최근 12개월 수익률이 높을 수록(Hi PRIOR) 향후에도 지속적으로 수익률이 높은 ‘모멘텀 현상’이 존재합니다.</p>
</div>
<div class="section" id="id13">
<h4>12.3.1.3 장기 모멘텀<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<p>마지막으로 최근 5년간 수익률을 기준으로 구성된 장기 모멘텀 포트폴리오의 수익률을 확인해보겠습니다. 해당 데이터의 이름은 ‘10_Portfolios_Prior_60_13’ 입니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas_datareader.data</span> <span class="k">as</span> <span class="nn">web</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>

<span class="n">df_long</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s1">&#39;10_Portfolios_Prior_60_13&#39;</span><span class="p">,</span> <span class="s1">&#39;famafrench&#39;</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;1900-01-01&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">df_long_cum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">df_long</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">df_long_cum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">colormap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Long Term Return&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/12_factor_basic_67_0.png" src="_images/12_factor_basic_67_0.png" />
</div>
</div>
<p>누적수익률을 확인해보면, 최근 60개월 수익률이 낮을 수록(Lo PRIOR) 향후에도 지속적으로 수익률이 높은 ‘장기 수익률 반전 현상’이 존재합니다.</p>
</div>
</div>
<div class="section" id="id14">
<h3>12.3.2 모멘텀 포트폴리오 구하기: 12개월 모멘텀<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<p>먼저 최근 1년 동안의 수익률이 높은 30종목을 선택하겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">statistics</span> <span class="kn">import</span> <span class="n">stdev</span> 

<span class="n">KOR_price</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/KOR_price.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">KOR_ticker</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/KOR_ticker.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">KOR_ticker</span><span class="p">[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KOR_ticker</span><span class="p">[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="n">ret</span> <span class="o">=</span> <span class="n">KOR_price</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
<span class="n">ret_12m</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">252</span><span class="p">:</span> <span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>가격 정보와 티커 정보를 불러옵니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pct_change()</span></code> 함수를 통해 수익률을 계산합니다.</p></li>
<li><p>최근 252일 수익률을 선택한 후, prod() 함수를 이용해 각 종목의 누적수익률을 계산해줍니다. (누적수익률: <span class="math notranslate nohighlight">\(\prod_{i=1}^n(1+r_i)-1\)</span>)</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">invest_mom</span> <span class="o">=</span> <span class="p">(</span><span class="n">ret_12m</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="n">invest_mom_df</span> <span class="o">=</span> <span class="n">KOR_ticker</span><span class="p">[</span><span class="n">invest_mom</span><span class="p">][[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">,</span> <span class="s1">&#39;종목명&#39;</span><span class="p">]]</span>
<span class="n">invest_mom_df</span><span class="p">[</span><span class="s1">&#39;수익률&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret_12m</span><span class="p">[</span><span class="n">invest_mom</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="n">invest_mom_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목코드</th>
      <th>종목명</th>
      <th>수익률</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>011200</td>
      <td>HMM</td>
      <td>8.3364</td>
    </tr>
    <tr>
      <th>90</th>
      <td>112610</td>
      <td>씨에스윈드</td>
      <td>4.9491</td>
    </tr>
    <tr>
      <th>96</th>
      <td>336260</td>
      <td>두산퓨얼셀</td>
      <td>8.0516</td>
    </tr>
    <tr>
      <th>169</th>
      <td>298050</td>
      <td>효성첨단소재</td>
      <td>4.9561</td>
    </tr>
    <tr>
      <th>179</th>
      <td>323990</td>
      <td>박셀바이오</td>
      <td>8.8404</td>
    </tr>
    <tr>
      <th>188</th>
      <td>194480</td>
      <td>데브시스터즈</td>
      <td>19.7658</td>
    </tr>
    <tr>
      <th>245</th>
      <td>041190</td>
      <td>우리기술투자</td>
      <td>5.1697</td>
    </tr>
    <tr>
      <th>250</th>
      <td>027360</td>
      <td>아주IB투자</td>
      <td>6.2736</td>
    </tr>
    <tr>
      <th>292</th>
      <td>217270</td>
      <td>넵튠</td>
      <td>4.6737</td>
    </tr>
    <tr>
      <th>323</th>
      <td>100090</td>
      <td>삼강엠앤티</td>
      <td>7.0312</td>
    </tr>
    <tr>
      <th>414</th>
      <td>156100</td>
      <td>엘앤케이바이오</td>
      <td>6.7461</td>
    </tr>
    <tr>
      <th>417</th>
      <td>048910</td>
      <td>대원미디어</td>
      <td>5.3348</td>
    </tr>
    <tr>
      <th>443</th>
      <td>025950</td>
      <td>동신건설</td>
      <td>10.0176</td>
    </tr>
    <tr>
      <th>450</th>
      <td>080580</td>
      <td>오킨스전자</td>
      <td>19.6030</td>
    </tr>
    <tr>
      <th>469</th>
      <td>208640</td>
      <td>썸에이지</td>
      <td>6.6022</td>
    </tr>
    <tr>
      <th>489</th>
      <td>007860</td>
      <td>서연</td>
      <td>4.9036</td>
    </tr>
    <tr>
      <th>514</th>
      <td>285490</td>
      <td>노바텍</td>
      <td>6.7383</td>
    </tr>
    <tr>
      <th>526</th>
      <td>241840</td>
      <td>에이스토리</td>
      <td>4.9156</td>
    </tr>
    <tr>
      <th>534</th>
      <td>033310</td>
      <td>엠투엔</td>
      <td>7.3333</td>
    </tr>
    <tr>
      <th>536</th>
      <td>004830</td>
      <td>덕성</td>
      <td>9.3448</td>
    </tr>
    <tr>
      <th>598</th>
      <td>217330</td>
      <td>싸이토젠</td>
      <td>6.3348</td>
    </tr>
    <tr>
      <th>632</th>
      <td>053290</td>
      <td>NE능률</td>
      <td>5.0773</td>
    </tr>
    <tr>
      <th>771</th>
      <td>050960</td>
      <td>수산아이앤티</td>
      <td>6.1942</td>
    </tr>
    <tr>
      <th>878</th>
      <td>353810</td>
      <td>이지바이오</td>
      <td>5.9617</td>
    </tr>
    <tr>
      <th>959</th>
      <td>045340</td>
      <td>토탈소프트</td>
      <td>7.6330</td>
    </tr>
    <tr>
      <th>969</th>
      <td>082850</td>
      <td>우리바이오</td>
      <td>5.0656</td>
    </tr>
    <tr>
      <th>1093</th>
      <td>014940</td>
      <td>오리엔탈정공</td>
      <td>5.3000</td>
    </tr>
    <tr>
      <th>1257</th>
      <td>181340</td>
      <td>이즈미디어</td>
      <td>6.6792</td>
    </tr>
    <tr>
      <th>1273</th>
      <td>019770</td>
      <td>서연탑메탈</td>
      <td>5.4450</td>
    </tr>
    <tr>
      <th>1484</th>
      <td>013720</td>
      <td>청보산업</td>
      <td>6.0573</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">rank()</span></code> 함수를 통해 순위를 구합니다. 모멘텀의 경우 높을수록 좋은 내림차순으로 순위를 계산해야 하므로 <code class="docutils literal notranslate"><span class="pre">ascending</span> <span class="pre">=</span> <span class="pre">False</span></code>를 설정해줍니다. 12개월 누적수익률이 높은 종목들이 선택됨이 확인됩니다.</p>
</div>
<div class="section" id="id15">
<h3>12.3.3 모멘텀 포트폴리오 구하기: 위험조정 수익률<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p>단순히 과거 수익률로만 모멘텀 종목을 선택하면 각종 테마나 이벤트에 따른 급등으로 인해 변동성이 지나치게 높은 종목이 있을 수도 있습니다. 누적수익률을 변동성으로 나누어 위험을 고려해줄 경우, 이러한 종목은 제외되며 상대적으로 안정적인 모멘텀 종목을 선택할 수 있습니다. 이를 흔히 샤프지수라고도 합니다.</p>
<div class="math notranslate nohighlight">
\[위험조정\ 수익률 = \frac{누적수익률}{변동성}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ret_12m</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">252</span><span class="p">:</span> <span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">std_12m</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">252</span><span class="p">:</span> <span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">stdev</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span>

<span class="n">sharpe_12m</span> <span class="o">=</span> <span class="n">ret_12m</span> <span class="o">/</span> <span class="n">std_12m</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>분자에 해당하는 최근 1년 누적수익률을 계산합니다.</p></li>
<li><p>분모에 해당하는 연율화 변동성을 계산합니다.</p></li>
<li><p>수익률을 변동성으로 나누어 위험조정 수익률을 계산해줍니다.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">invest_mom_sharpe</span> <span class="o">=</span> <span class="p">(</span><span class="n">sharpe_12m</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="n">invest_mom_sharpe_df</span> <span class="o">=</span> <span class="n">KOR_ticker</span><span class="p">[</span><span class="n">invest_mom_sharpe</span><span class="p">][[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">,</span> <span class="s1">&#39;종목명&#39;</span><span class="p">]]</span>
<span class="n">invest_mom_sharpe_df</span><span class="p">[</span><span class="s1">&#39;수익률&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret_12m</span><span class="p">[</span><span class="n">invest_mom_sharpe</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">invest_mom_sharpe_df</span><span class="p">[</span><span class="s1">&#39;변동성&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">std_12m</span><span class="p">[</span><span class="n">invest_mom_sharpe</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">invest_mom_sharpe_df</span><span class="p">[</span><span class="s1">&#39;위험조정 수익률&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sharpe_12m</span><span class="p">[</span><span class="n">invest_mom_sharpe</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="n">invest_mom_sharpe_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목코드</th>
      <th>종목명</th>
      <th>수익률</th>
      <th>변동성</th>
      <th>위험조정 수익률</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>035720</td>
      <td>카카오</td>
      <td>2.4766</td>
      <td>0.3841</td>
      <td>6.4481</td>
    </tr>
    <tr>
      <th>32</th>
      <td>011200</td>
      <td>HMM</td>
      <td>8.3364</td>
      <td>0.6318</td>
      <td>13.1938</td>
    </tr>
    <tr>
      <th>90</th>
      <td>112610</td>
      <td>씨에스윈드</td>
      <td>4.9491</td>
      <td>0.6666</td>
      <td>7.4242</td>
    </tr>
    <tr>
      <th>96</th>
      <td>336260</td>
      <td>두산퓨얼셀</td>
      <td>8.0516</td>
      <td>0.9573</td>
      <td>8.4105</td>
    </tr>
    <tr>
      <th>119</th>
      <td>066970</td>
      <td>엘앤에프</td>
      <td>4.2721</td>
      <td>0.6577</td>
      <td>6.4951</td>
    </tr>
    <tr>
      <th>130</th>
      <td>298020</td>
      <td>효성티앤씨</td>
      <td>4.2000</td>
      <td>0.5970</td>
      <td>7.0352</td>
    </tr>
    <tr>
      <th>169</th>
      <td>298050</td>
      <td>효성첨단소재</td>
      <td>4.9561</td>
      <td>0.5968</td>
      <td>8.3039</td>
    </tr>
    <tr>
      <th>175</th>
      <td>042700</td>
      <td>한미반도체</td>
      <td>3.5235</td>
      <td>0.5463</td>
      <td>6.4502</td>
    </tr>
    <tr>
      <th>188</th>
      <td>194480</td>
      <td>데브시스터즈</td>
      <td>19.7658</td>
      <td>0.9690</td>
      <td>20.3979</td>
    </tr>
    <tr>
      <th>234</th>
      <td>002840</td>
      <td>미원상사</td>
      <td>2.8860</td>
      <td>0.3546</td>
      <td>8.1383</td>
    </tr>
    <tr>
      <th>250</th>
      <td>027360</td>
      <td>아주IB투자</td>
      <td>6.2736</td>
      <td>0.7387</td>
      <td>8.4926</td>
    </tr>
    <tr>
      <th>323</th>
      <td>100090</td>
      <td>삼강엠앤티</td>
      <td>7.0312</td>
      <td>0.7999</td>
      <td>8.7898</td>
    </tr>
    <tr>
      <th>364</th>
      <td>131290</td>
      <td>티에스이</td>
      <td>4.4545</td>
      <td>0.6557</td>
      <td>6.7931</td>
    </tr>
    <tr>
      <th>414</th>
      <td>156100</td>
      <td>엘앤케이바이오</td>
      <td>6.7461</td>
      <td>1.0188</td>
      <td>6.6214</td>
    </tr>
    <tr>
      <th>417</th>
      <td>048910</td>
      <td>대원미디어</td>
      <td>5.3348</td>
      <td>0.7363</td>
      <td>7.2459</td>
    </tr>
    <tr>
      <th>427</th>
      <td>104700</td>
      <td>한국철강</td>
      <td>2.4175</td>
      <td>0.3475</td>
      <td>6.9568</td>
    </tr>
    <tr>
      <th>443</th>
      <td>025950</td>
      <td>동신건설</td>
      <td>10.0176</td>
      <td>1.1937</td>
      <td>8.3923</td>
    </tr>
    <tr>
      <th>450</th>
      <td>080580</td>
      <td>오킨스전자</td>
      <td>19.6030</td>
      <td>0.8627</td>
      <td>22.7226</td>
    </tr>
    <tr>
      <th>468</th>
      <td>016710</td>
      <td>대성홀딩스</td>
      <td>2.3000</td>
      <td>0.2892</td>
      <td>7.9518</td>
    </tr>
    <tr>
      <th>469</th>
      <td>208640</td>
      <td>썸에이지</td>
      <td>6.6022</td>
      <td>1.0313</td>
      <td>6.4015</td>
    </tr>
    <tr>
      <th>514</th>
      <td>285490</td>
      <td>노바텍</td>
      <td>6.7383</td>
      <td>0.8799</td>
      <td>7.6580</td>
    </tr>
    <tr>
      <th>526</th>
      <td>241840</td>
      <td>에이스토리</td>
      <td>4.9156</td>
      <td>0.7708</td>
      <td>6.3775</td>
    </tr>
    <tr>
      <th>534</th>
      <td>033310</td>
      <td>엠투엔</td>
      <td>7.3333</td>
      <td>0.9550</td>
      <td>7.6787</td>
    </tr>
    <tr>
      <th>536</th>
      <td>004830</td>
      <td>덕성</td>
      <td>9.3448</td>
      <td>1.0545</td>
      <td>8.8621</td>
    </tr>
    <tr>
      <th>598</th>
      <td>217330</td>
      <td>싸이토젠</td>
      <td>6.3348</td>
      <td>0.7798</td>
      <td>8.1233</td>
    </tr>
    <tr>
      <th>781</th>
      <td>054920</td>
      <td>한컴위드</td>
      <td>3.9161</td>
      <td>0.4947</td>
      <td>7.9156</td>
    </tr>
    <tr>
      <th>959</th>
      <td>045340</td>
      <td>토탈소프트</td>
      <td>7.6330</td>
      <td>0.9682</td>
      <td>7.8833</td>
    </tr>
    <tr>
      <th>1093</th>
      <td>014940</td>
      <td>오리엔탈정공</td>
      <td>5.3000</td>
      <td>0.8220</td>
      <td>6.4477</td>
    </tr>
    <tr>
      <th>1257</th>
      <td>181340</td>
      <td>이즈미디어</td>
      <td>6.6792</td>
      <td>0.8481</td>
      <td>7.8754</td>
    </tr>
    <tr>
      <th>1484</th>
      <td>013720</td>
      <td>청보산업</td>
      <td>6.0573</td>
      <td>0.6645</td>
      <td>9.1156</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>티커와 종목명, 누적수익률, 변동성, 위험조정 수익률을 확인할 수 있습니다. 다음으로 위험조정 수익률 상위 30종목의 가격 그래프를 확인해보도록 하겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">select_sharpe</span> <span class="o">=</span> <span class="n">KOR_price</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">252</span><span class="p">:,</span> <span class="n">invest_mom_sharpe</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">select_sharpe</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">select_sharpe</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">n</span><span class="p">])</span>                   
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">select_sharpe</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/12_factor_basic_81_0.png" src="_images/12_factor_basic_81_0.png" />
</div>
</div>
</div>
<div class="section" id="k-ratio">
<h3>12.3.4 K-Ratio<a class="headerlink" href="#k-ratio" title="Permalink to this headline">¶</a></h3>
<p>위 예제를 통해 수익률에 위험을 조정하기는 했지만, 일부 종목의 경우 최근 주가가 급등하여 누적수익률 역시 높게 나타나는 현상이 벌어지고는 합니다. 그러나 좋은 모멘텀이란 단순히 많이 상승한 것이 아닌, 꾸준하게 상승하는 종목입니다.</p>
<div class="figure align-default" id="factor-k">
<img alt="_images/factor_k.png" src="_images/factor_k.png" />
<p class="caption"><span class="caption-number">Fig. 67 </span><span class="caption-text">모멘텀의 종류</span><a class="headerlink" href="#factor-k" title="Permalink to this image">¶</a></p>
</div>
<p>동일한 누적수익률을 가진 두 종목이 있습니다. A의 경우 상승폭이 작다가 최근 급등하여 누적수익률이 높아진 경우입니다. 반면 B의 경우 꾸준하게 상승하여 누적수익률이 높아진 경우입니다. 이처럼 꾸준한 상승을 측정하는 지표가 K-Ratio 입니다(Kestner 2013). 해당 지수는 다음과 같습니다.</p>
<div class="math notranslate nohighlight">
\[K-Ratio = \frac{누적수익률의\ 기울기}{표준\ 오차}\]</div>
<p>누적수익률이 높을수록 기울기도 커져 분자는 커집니다. 또한 추세가 꾸준할수록 표준 오차가 작아 분자는 작아집니다. 따라서 추세가 꾸준하게 많이 상승할수록 K-Ratio는 증가하게 됩니다. 이번에는 K-Ratio가 높은 30종목을 선택하겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">KOR_price</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/KOR_price.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">KOR_ticker</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/KOR_ticker.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">KOR_ticker</span><span class="p">[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KOR_ticker</span><span class="p">[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="n">ret</span> <span class="o">=</span> <span class="n">KOR_price</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
<span class="n">ret_cumindex</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">252</span><span class="p">:</span> <span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>가격 정보와 티커 정보를 불러옵니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pct_change()</span></code> 함수를 통해 수익률을 계산합니다.</p></li>
<li><p>최근 252일 수익률을 선택한 후, 시간에 따른 누적수익률을 계산합니다.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">252</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ret_cumindex</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">reg</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">reg</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>            <td>y</td>        <th>  R-squared (uncentered):</th>      <td>   0.936</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared (uncentered):</th> <td>   0.935</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th>          <td>   3644.</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Wed, 14 Apr 2021</td> <th>  Prob (F-statistic):</th>          <td>1.82e-151</td>
</tr>
<tr>
  <th>Time:</th>                 <td>17:58:37</td>     <th>  Log-Likelihood:    </th>          <td>  198.25</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   252</td>      <th>  AIC:               </th>          <td>  -394.5</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   251</td>      <th>  BIC:               </th>          <td>  -391.0</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>              <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>              <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
   <td></td>     <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>x1</th> <td>    0.0029</td> <td> 4.79e-05</td> <td>   60.369</td> <td> 0.000</td> <td>    0.003</td> <td>    0.003</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>36.705</td> <th>  Durbin-Watson:     </th> <td>   0.048</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  49.192</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.956</td> <th>  Prob(JB):          </th> <td>2.08e-11</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.016</td> <th>  Cond. No.          </th> <td>    1.00</td>
</tr>
</table><br/><br/>Notes:<br/>[1] R² is computed without centering (uncentered) since the model does not contain a constant.<br/>[2] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<p>먼저 예시로써 첫번째 종목의 K-Ratio를 계산합니다. <span class="math notranslate nohighlight">\(x\)</span>축은 시간, <span class="math notranslate nohighlight">\(y\)</span>축은 누적수익률로 두며, <code class="docutils literal notranslate"><span class="pre">OLS()</span></code> 함수를 통해 회귀분석을 실시합니다. 결과표의 coef는 기울기를, std err는 표준 오차를 나타냅니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">reg</span><span class="o">.</span><span class="n">bse</span><span class="p">,</span> <span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">params</span> <span class="o">/</span> <span class="n">reg</span><span class="o">.</span><span class="n">bse</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.00289418] [4.79417215e-05] [60.36871848]
</pre></div>
</div>
</div>
</div>
<p>기울기를 표준 오차로 나누어주면 K-Ratio가 계산됩니다. 이제 모든 종목의 K-Ratio를 계산하도록 하겠습니다</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">252</span><span class="p">))</span>
<span class="n">k_result</span> <span class="o">=</span> <span class="p">{}</span>
    
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">KOR_ticker</span><span class="p">))</span> <span class="p">:</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">ret_cumindex</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">params</span> <span class="o">/</span> <span class="n">reg</span><span class="o">.</span><span class="n">bse</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        
    <span class="n">k_result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>

<span class="n">K_ratio</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">k_result</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">loop</span></code> 구문을 내에 <span class="math notranslate nohighlight">\(x\)</span> 축에는 시간, <span class="math notranslate nohighlight">\(y\)</span> 축에는 누적수익률을 입력하여 모든 종목의 K-Ratio를 계산합니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">invest_K</span> <span class="o">=</span> <span class="p">(</span><span class="n">K_ratio</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="n">invest_K_df</span> <span class="o">=</span> <span class="n">KOR_ticker</span><span class="p">[</span><span class="n">invest_K</span><span class="p">][[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">,</span> <span class="s1">&#39;종목명&#39;</span><span class="p">]]</span>
<span class="n">invest_K_df</span><span class="p">[</span><span class="s1">&#39;K-Ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">K_ratio</span><span class="p">[</span><span class="n">invest_K</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="n">invest_K_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목코드</th>
      <th>종목명</th>
      <th>K-Ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>161390</td>
      <td>한국타이어앤테크놀로지</td>
      <td>103.6740</td>
    </tr>
    <tr>
      <th>108</th>
      <td>014680</td>
      <td>한솔케미칼</td>
      <td>93.2512</td>
    </tr>
    <tr>
      <th>190</th>
      <td>086520</td>
      <td>에코프로</td>
      <td>89.1821</td>
    </tr>
    <tr>
      <th>276</th>
      <td>103140</td>
      <td>풍산</td>
      <td>104.4383</td>
    </tr>
    <tr>
      <th>421</th>
      <td>232140</td>
      <td>와이아이케이</td>
      <td>92.5253</td>
    </tr>
    <tr>
      <th>468</th>
      <td>016710</td>
      <td>대성홀딩스</td>
      <td>140.3079</td>
    </tr>
    <tr>
      <th>471</th>
      <td>101160</td>
      <td>월덱스</td>
      <td>104.6588</td>
    </tr>
    <tr>
      <th>472</th>
      <td>009410</td>
      <td>태영건설</td>
      <td>90.7749</td>
    </tr>
    <tr>
      <th>500</th>
      <td>078020</td>
      <td>이베스트투자증권</td>
      <td>94.6895</td>
    </tr>
    <tr>
      <th>710</th>
      <td>317400</td>
      <td>자이에스앤디</td>
      <td>89.7264</td>
    </tr>
    <tr>
      <th>729</th>
      <td>079370</td>
      <td>제우스</td>
      <td>92.5104</td>
    </tr>
    <tr>
      <th>781</th>
      <td>054920</td>
      <td>한컴위드</td>
      <td>95.6803</td>
    </tr>
    <tr>
      <th>820</th>
      <td>055490</td>
      <td>테이팩스</td>
      <td>105.1518</td>
    </tr>
    <tr>
      <th>838</th>
      <td>044450</td>
      <td>KSS해운</td>
      <td>113.3442</td>
    </tr>
    <tr>
      <th>877</th>
      <td>003200</td>
      <td>일신방직</td>
      <td>106.2753</td>
    </tr>
    <tr>
      <th>954</th>
      <td>001070</td>
      <td>대한방직</td>
      <td>94.7479</td>
    </tr>
    <tr>
      <th>1003</th>
      <td>023450</td>
      <td>동남합성</td>
      <td>91.2803</td>
    </tr>
    <tr>
      <th>1036</th>
      <td>014280</td>
      <td>금강공업</td>
      <td>101.7182</td>
    </tr>
    <tr>
      <th>1084</th>
      <td>000180</td>
      <td>성창기업지주</td>
      <td>95.8059</td>
    </tr>
    <tr>
      <th>1093</th>
      <td>014940</td>
      <td>오리엔탈정공</td>
      <td>95.7546</td>
    </tr>
    <tr>
      <th>1405</th>
      <td>032560</td>
      <td>황금에스티</td>
      <td>93.9617</td>
    </tr>
    <tr>
      <th>1649</th>
      <td>093520</td>
      <td>매커스</td>
      <td>97.8931</td>
    </tr>
    <tr>
      <th>1687</th>
      <td>089850</td>
      <td>유비벨록스</td>
      <td>99.7750</td>
    </tr>
    <tr>
      <th>1697</th>
      <td>021650</td>
      <td>한국큐빅</td>
      <td>92.5266</td>
    </tr>
    <tr>
      <th>1745</th>
      <td>069730</td>
      <td>DSR제강</td>
      <td>93.4739</td>
    </tr>
    <tr>
      <th>1776</th>
      <td>001560</td>
      <td>제일연마</td>
      <td>99.7827</td>
    </tr>
    <tr>
      <th>1970</th>
      <td>279600</td>
      <td>미디어젠</td>
      <td>90.8025</td>
    </tr>
    <tr>
      <th>1983</th>
      <td>008470</td>
      <td>부스타</td>
      <td>111.8410</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>069140</td>
      <td>누리플랜</td>
      <td>92.0951</td>
    </tr>
    <tr>
      <th>2118</th>
      <td>044780</td>
      <td>에이치케이</td>
      <td>89.0433</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>상위 30 종목의 K-Ratio 입니다. 각 종목의 주가를 그림으로 확인해보겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">select_K</span> <span class="o">=</span> <span class="n">KOR_price</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">252</span><span class="p">:,</span> <span class="n">invest_K</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">select_K</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">select_K</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">n</span><span class="p">])</span>                   
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">select_K</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/12_factor_basic_94_0.png" src="_images/12_factor_basic_94_0.png" />
</div>
</div>
<p>대부분의 종목이 장기간 동안 꾸준히 상승하는 종목임을 확인할 수 있습니다.</p>
</div>
</div>
<div class="section" id="id16">
<h2>12.4 밸류 전략<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h2>
<p>가치주 효과란 내재 가치 대비 낮은 가격의 주식(저PER, 저PBR 등)이, 내재 가치 대비 비싼 주식보다 수익률이 높은 현상(Basu 1977)을 뜻합니다. 가치 효과가 발생하는 원인에 대한 이론은 다음과 같습니다.</p>
<ol class="simple">
<li><p>위험한 기업은 시장에서 상대적으로 낮은 가격에 거래되며, 이러한 위험을 감당하는 대가로 수익이 발생합니다.</p></li>
<li><p>투자자들의 성장주에 대한 과잉 반응으로 인해 가치주는 시장에서 소외되며, 제자리를 찾아가는 과정에서 수익이 발생합니다.</p></li>
</ol>
<p>기업의 가치를 나타내는 지표는 굉장히 많지만, 일반적으로 PER, PBR, PCR, PSR이 많이 사용됩니다.</p>
<div class="section" id="id17">
<h3>12.4.1 가치지표 별 누적 수익률<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p>먼저 기업의 가치 여부를 판단할 때 가장 많이 사용되는 지표인 PBR을 기준으로 구성된 포트폴리오의 수익률을 비교해보겠습니다. 프렌치 라이브러리에서 해당 데이터의 이름은 ‘Portfolios_Formed_on_BE-ME’ 입니다. B/M에서 B는 장부가치(Book Value), M는 시장가치(Market Value)로써, 이는 PBR의 역수라고 생각해도 됩니다. 즉 해당값이 높을수록 저PBR 주식입니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas_datareader.data</span> <span class="k">as</span> <span class="nn">web</span>

<span class="n">df_pbr</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s1">&#39;Portfolios_Formed_on_BE-ME&#39;</span><span class="p">,</span> <span class="s1">&#39;famafrench&#39;</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;1900-01-01&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">df_pbr</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>&lt;= 0</th>
      <th>Lo 30</th>
      <th>Med 40</th>
      <th>Hi 30</th>
      <th>Lo 20</th>
      <th>Qnt 2</th>
      <th>Qnt 3</th>
      <th>Qnt 4</th>
      <th>Hi 20</th>
      <th>Lo 10</th>
      <th>Dec 2</th>
      <th>Dec 3</th>
      <th>Dec 4</th>
      <th>Dec 5</th>
      <th>Dec 6</th>
      <th>Dec 7</th>
      <th>Dec 8</th>
      <th>Dec 9</th>
      <th>Hi 10</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1926-07</th>
      <td>12.07</td>
      <td>5.56</td>
      <td>1.92</td>
      <td>1.06</td>
      <td>3.19</td>
      <td>5.41</td>
      <td>1.77</td>
      <td>2.44</td>
      <td>0.60</td>
      <td>4.63</td>
      <td>1.24</td>
      <td>11.40</td>
      <td>1.68</td>
      <td>1.50</td>
      <td>2.09</td>
      <td>2.73</td>
      <td>1.58</td>
      <td>0.63</td>
      <td>0.52</td>
    </tr>
    <tr>
      <th>1926-08</th>
      <td>-9.73</td>
      <td>2.64</td>
      <td>2.64</td>
      <td>6.09</td>
      <td>1.00</td>
      <td>4.01</td>
      <td>2.05</td>
      <td>4.58</td>
      <td>7.10</td>
      <td>0.15</td>
      <td>2.18</td>
      <td>6.40</td>
      <td>2.38</td>
      <td>1.58</td>
      <td>2.63</td>
      <td>4.46</td>
      <td>4.94</td>
      <td>8.31</td>
      <td>3.92</td>
    </tr>
    <tr>
      <th>1926-09</th>
      <td>-15.16</td>
      <td>1.29</td>
      <td>0.06</td>
      <td>-0.71</td>
      <td>-1.03</td>
      <td>3.05</td>
      <td>-0.30</td>
      <td>-0.17</td>
      <td>-1.46</td>
      <td>-0.11</td>
      <td>-2.30</td>
      <td>6.32</td>
      <td>0.73</td>
      <td>-0.89</td>
      <td>0.38</td>
      <td>-0.28</td>
      <td>0.17</td>
      <td>-2.16</td>
      <td>0.44</td>
    </tr>
    <tr>
      <th>1926-10</th>
      <td>-5.63</td>
      <td>-3.59</td>
      <td>-2.42</td>
      <td>-3.59</td>
      <td>-2.88</td>
      <td>-2.96</td>
      <td>-2.21</td>
      <td>-4.18</td>
      <td>-4.28</td>
      <td>-3.78</td>
      <td>-1.63</td>
      <td>-5.01</td>
      <td>-1.41</td>
      <td>-2.31</td>
      <td>-2.10</td>
      <td>-4.65</td>
      <td>-2.80</td>
      <td>-5.46</td>
      <td>-1.17</td>
    </tr>
    <tr>
      <th>1926-11</th>
      <td>5.58</td>
      <td>3.13</td>
      <td>2.92</td>
      <td>3.13</td>
      <td>4.11</td>
      <td>2.57</td>
      <td>1.89</td>
      <td>3.96</td>
      <td>2.48</td>
      <td>6.03</td>
      <td>1.49</td>
      <td>1.11</td>
      <td>3.63</td>
      <td>1.97</td>
      <td>1.80</td>
      <td>4.00</td>
      <td>3.85</td>
      <td>2.77</td>
      <td>1.76</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>기존의 모멘텀과는 다르게 열이 상당히 많습니다. 각 열에 대한 설명은 다음과 같습니다.</p>
<ul class="simple">
<li><p>&lt;=0: PBR이 0 이하인 기업들의 포트폴리오</p></li>
<li><p>Lo 30, Med 40, Hi 30: PBR 기준 상위 30%, 30-70%, 하위 30%로 나눈 포트폴리오</p></li>
<li><p>Lo 20, Qnt 2, Qnt 3, Qnt 4, Hi 20: PBR 기준 상위 20%, 20-40%, 40-60%, 60-80%, 80-100%로 나눈 포트폴리오</p></li>
<li><p>Lo 10, Dec 2, Dec 3, …, Dec 9, Hi 19: PBR 기준 상위 10% 씩으로 나눈 포트폴리오</p></li>
</ul>
<p>이 중 20%씩 나눈 [Lo 20, Qnt 2, Qnt 3, Qnt 4, Hi 20] 열만 선택하여 누적 수익률을 확인해보겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>

<span class="n">df_pbr</span> <span class="o">=</span> <span class="n">df_pbr</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;Lo 20&#39;</span><span class="p">,</span> <span class="s1">&#39;Qnt 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Qnt 3&#39;</span><span class="p">,</span> <span class="s1">&#39;Qnt 4&#39;</span><span class="p">,</span> <span class="s1">&#39;Hi 20&#39;</span><span class="p">]]</span>
<span class="n">df_pbr_cum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">df_pbr</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">df_pbr_cum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">colormap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;PBR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/12_factor_basic_101_0.png" src="_images/12_factor_basic_101_0.png" />
</div>
</div>
<p>B/M 값이 높을 수록, 즉 PBR이 낮을 수록 수익률이 높은 가치주 효과가 확인됩니다.</p>
<p>프렌치 라이브러리에는 B/M(PBR) 외에도 E/P(PER), CF/P(PCR) 데이터도 존재하므로, 해당 지표역시 누적 수익률을 확인해보도록 하겠습니다. 먼저 PER의 역수에 해당하는 E/P 지표의 누적 수익률은 다음과 같습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_per</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s1">&#39;Portfolios_Formed_on_E-P&#39;</span><span class="p">,</span> <span class="s1">&#39;famafrench&#39;</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;1900-01-01&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">df_per</span> <span class="o">=</span> <span class="n">df_per</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;Lo 20&#39;</span><span class="p">,</span> <span class="s1">&#39;Qnt 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Qnt 3&#39;</span><span class="p">,</span> <span class="s1">&#39;Qnt 4&#39;</span><span class="p">,</span> <span class="s1">&#39;Hi 20&#39;</span><span class="p">]]</span>
<span class="n">df_per_cum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">df_per</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">df_per_cum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">colormap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;PER&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/12_factor_basic_103_0.png" src="_images/12_factor_basic_103_0.png" />
</div>
</div>
<p>Hi 20, 즉 PER가 낮을 수록 수익률이 높습니다. 이번에는 PCR의 역수에 해당하는 CF/P 지표의 누적 수익률을 살펴보겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pcr</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s1">&#39;Portfolios_Formed_on_CF-P&#39;</span><span class="p">,</span> <span class="s1">&#39;famafrench&#39;</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;1900-01-01&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">df_pcr</span> <span class="o">=</span> <span class="n">df_pcr</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;Lo 20&#39;</span><span class="p">,</span> <span class="s1">&#39;Qnt 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Qnt 3&#39;</span><span class="p">,</span> <span class="s1">&#39;Qnt 4&#39;</span><span class="p">,</span> <span class="s1">&#39;Hi 20&#39;</span><span class="p">]]</span>
<span class="n">df_pcr_cum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">df_pcr</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">df_pcr_cum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">colormap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;PCR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/12_factor_basic_105_0.png" src="_images/12_factor_basic_105_0.png" />
</div>
</div>
<p>역시나 Hi 20, 즉 PCR이 낮을 수록 수익률이 높습니다. 즉, PBR 뿐만 아니라 PER, PCR과 같은 모든 지표에서 가치주 효과가 나타납니다.</p>
</div>
<div class="section" id="pbr">
<h3>12.4.2 밸류 포트폴리오 구하기: 저PBR<a class="headerlink" href="#pbr" title="Permalink to this headline">¶</a></h3>
<p>먼저 국내 기업 중 저 PBR을 기준으로 종목을 선정해보도록 하겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">KOR_ticker</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/KOR_ticker.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">KOR_ticker</span><span class="p">[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KOR_ticker</span><span class="p">[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="n">KOR_value</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/KOR_value.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">KOR_value</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">KOR_value</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="n">invest_pbr</span> <span class="o">=</span> <span class="p">(</span><span class="n">KOR_value</span><span class="p">[</span><span class="s1">&#39;PBR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">invest_pbr_df</span> <span class="o">=</span> <span class="n">KOR_ticker</span><span class="p">[</span><span class="n">invest_pbr</span><span class="p">][[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">,</span> <span class="s1">&#39;종목명&#39;</span><span class="p">]]</span>
<span class="n">invest_pbr_df</span><span class="p">[</span><span class="s1">&#39;PBR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KOR_value</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">invest_pbr</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;PBR&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="n">invest_pbr_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목코드</th>
      <th>종목명</th>
      <th>PBR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>23</th>
      <td>015760</td>
      <td>한국전력</td>
      <td>0.2171</td>
    </tr>
    <tr>
      <th>117</th>
      <td>001040</td>
      <td>CJ</td>
      <td>0.1804</td>
    </tr>
    <tr>
      <th>136</th>
      <td>000880</td>
      <td>한화</td>
      <td>0.1270</td>
    </tr>
    <tr>
      <th>291</th>
      <td>003380</td>
      <td>하림지주</td>
      <td>0.2505</td>
    </tr>
    <tr>
      <th>304</th>
      <td>000150</td>
      <td>두산</td>
      <td>0.1056</td>
    </tr>
    <tr>
      <th>321</th>
      <td>012630</td>
      <td>HDC</td>
      <td>0.1705</td>
    </tr>
    <tr>
      <th>383</th>
      <td>009970</td>
      <td>영원무역홀딩스</td>
      <td>0.2363</td>
    </tr>
    <tr>
      <th>441</th>
      <td>032190</td>
      <td>다우데이타</td>
      <td>0.1610</td>
    </tr>
    <tr>
      <th>491</th>
      <td>071320</td>
      <td>지역난방공사</td>
      <td>0.2516</td>
    </tr>
    <tr>
      <th>607</th>
      <td>003300</td>
      <td>한일홀딩스</td>
      <td>0.2023</td>
    </tr>
    <tr>
      <th>627</th>
      <td>058650</td>
      <td>세아홀딩스</td>
      <td>0.1295</td>
    </tr>
    <tr>
      <th>673</th>
      <td>004690</td>
      <td>삼천리</td>
      <td>0.2335</td>
    </tr>
    <tr>
      <th>674</th>
      <td>001940</td>
      <td>KISCO홀딩스</td>
      <td>0.2409</td>
    </tr>
    <tr>
      <th>722</th>
      <td>036530</td>
      <td>SNT홀딩스</td>
      <td>0.1860</td>
    </tr>
    <tr>
      <th>797</th>
      <td>002030</td>
      <td>아세아</td>
      <td>0.1807</td>
    </tr>
    <tr>
      <th>800</th>
      <td>092230</td>
      <td>KPX홀딩스</td>
      <td>0.2042</td>
    </tr>
    <tr>
      <th>801</th>
      <td>005720</td>
      <td>넥센</td>
      <td>0.1291</td>
    </tr>
    <tr>
      <th>875</th>
      <td>003030</td>
      <td>세아제강지주</td>
      <td>0.1821</td>
    </tr>
    <tr>
      <th>879</th>
      <td>008060</td>
      <td>대덕</td>
      <td>0.1772</td>
    </tr>
    <tr>
      <th>901</th>
      <td>151860</td>
      <td>KG ETS</td>
      <td>0.2180</td>
    </tr>
    <tr>
      <th>1312</th>
      <td>054800</td>
      <td>아이디스홀딩스</td>
      <td>0.2218</td>
    </tr>
    <tr>
      <th>1342</th>
      <td>005990</td>
      <td>매일홀딩스</td>
      <td>0.2248</td>
    </tr>
    <tr>
      <th>1372</th>
      <td>006980</td>
      <td>우성사료</td>
      <td>0.0712</td>
    </tr>
    <tr>
      <th>1447</th>
      <td>009200</td>
      <td>무림페이퍼</td>
      <td>0.1904</td>
    </tr>
    <tr>
      <th>1626</th>
      <td>012320</td>
      <td>경동인베스트</td>
      <td>0.2221</td>
    </tr>
    <tr>
      <th>1643</th>
      <td>005010</td>
      <td>휴스틸</td>
      <td>0.2207</td>
    </tr>
    <tr>
      <th>1767</th>
      <td>021820</td>
      <td>세원정공</td>
      <td>0.1526</td>
    </tr>
    <tr>
      <th>1987</th>
      <td>025530</td>
      <td>SJM홀딩스</td>
      <td>0.2301</td>
    </tr>
    <tr>
      <th>2175</th>
      <td>039230</td>
      <td>에이아이비트</td>
      <td>0.1470</td>
    </tr>
    <tr>
      <th>2195</th>
      <td>028040</td>
      <td>미래SCI</td>
      <td>0.0452</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="simple">
<li><p>저장해둔 티커 정보와 가치 지표를 불러옵니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rank()</span></code>를 통해 PBR이 낮은 30종목을 선택합니다.</p></li>
<li><p>종목코드와 종목명, PBR을 확인합니다.</p></li>
</ol>
<p>홀딩스 등 지주사가 그 특성상 저PBR 포트폴리오에 많이 구성되어 있습니다.</p>
</div>
<div class="section" id="id18">
<h3>12.4.3 각 지표 결합하기<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<p>이번에는 PER, PBR, PCR, PSR 모든 지표를 고려한 밸류 포트폴리오를 짜보도록 하겠습니다. 먼저 각 지표 별 상관관계를 살펴봅시다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">rank_value</span>  <span class="o">=</span> <span class="n">KOR_value</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">rank_value</span><span class="o">.</span><span class="n">corr</span><span class="p">())</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">rank_value</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="p">,</span> <span class="n">annot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">annot_kws</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;size&quot;</span> <span class="p">:</span> <span class="mi">16</span><span class="p">},</span>
            <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span> <span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">square</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/12_factor_basic_113_0.png" src="_images/12_factor_basic_113_0.png" />
</div>
</div>
<p>먼저 <code class="docutils literal notranslate"><span class="pre">rank()</span></code> 함수 내 axis=0 을 통해 각 열별로 순위를 구해주며, <code class="docutils literal notranslate"><span class="pre">heatmap()</span></code> 함수를 통해 지표 별 상관관계를 히트맵으로 나타냅니다. 같은 가치지표임에도 불구하고 서로 간의 상관관계가 꽤 낮은 지표도 있습니다. 따라서 지표를 통합적으로 고려하면 분산효과를 기대할 수도 있습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rank_sum</span> <span class="o">=</span> <span class="n">rank_value</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">invest_value</span>  <span class="o">=</span> <span class="p">(</span><span class="n">rank_sum</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">invest_value_df</span> <span class="o">=</span> <span class="n">KOR_ticker</span><span class="p">[</span><span class="n">invest_value</span><span class="p">][[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">,</span> <span class="s1">&#39;종목명&#39;</span><span class="p">]]</span> 

<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">invest_value_df</span><span class="p">,</span> <span class="n">KOR_value</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">invest_value</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;종목코드&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목코드</th>
      <th>종목명</th>
      <th>PER</th>
      <th>PBR</th>
      <th>PCR</th>
      <th>PSR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>015760</td>
      <td>한국전력</td>
      <td>7.704987</td>
      <td>0.217117</td>
      <td>1.161596</td>
      <td>0.261962</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000880</td>
      <td>한화</td>
      <td>10.991377</td>
      <td>0.126975</td>
      <td>0.682551</td>
      <td>0.046144</td>
    </tr>
    <tr>
      <th>2</th>
      <td>018670</td>
      <td>SK가스</td>
      <td>3.616976</td>
      <td>0.505580</td>
      <td>4.201074</td>
      <td>0.217561</td>
    </tr>
    <tr>
      <th>3</th>
      <td>003380</td>
      <td>하림지주</td>
      <td>15.817968</td>
      <td>0.250454</td>
      <td>1.290829</td>
      <td>0.112030</td>
    </tr>
    <tr>
      <th>4</th>
      <td>000070</td>
      <td>삼양홀딩스</td>
      <td>7.660125</td>
      <td>0.363499</td>
      <td>3.191979</td>
      <td>0.317105</td>
    </tr>
    <tr>
      <th>5</th>
      <td>009970</td>
      <td>영원무역홀딩스</td>
      <td>5.894891</td>
      <td>0.236282</td>
      <td>1.384316</td>
      <td>0.216897</td>
    </tr>
    <tr>
      <th>6</th>
      <td>009410</td>
      <td>태영건설</td>
      <td>0.859301</td>
      <td>0.739732</td>
      <td>0.503217</td>
      <td>0.209712</td>
    </tr>
    <tr>
      <th>7</th>
      <td>002020</td>
      <td>코오롱</td>
      <td>2.740095</td>
      <td>0.476247</td>
      <td>1.228148</td>
      <td>0.083656</td>
    </tr>
    <tr>
      <th>8</th>
      <td>084690</td>
      <td>대상홀딩스</td>
      <td>4.443890</td>
      <td>0.293578</td>
      <td>2.697746</td>
      <td>0.103690</td>
    </tr>
    <tr>
      <th>9</th>
      <td>000140</td>
      <td>하이트진로홀딩스</td>
      <td>5.954604</td>
      <td>0.362195</td>
      <td>1.050525</td>
      <td>0.170927</td>
    </tr>
    <tr>
      <th>10</th>
      <td>001390</td>
      <td>KG케미칼</td>
      <td>8.987284</td>
      <td>0.257512</td>
      <td>1.251211</td>
      <td>0.105320</td>
    </tr>
    <tr>
      <th>11</th>
      <td>016450</td>
      <td>한세예스24홀딩스</td>
      <td>7.176471</td>
      <td>0.523465</td>
      <td>3.545867</td>
      <td>0.139533</td>
    </tr>
    <tr>
      <th>12</th>
      <td>003300</td>
      <td>한일홀딩스</td>
      <td>7.512057</td>
      <td>0.202283</td>
      <td>1.471248</td>
      <td>0.240539</td>
    </tr>
    <tr>
      <th>13</th>
      <td>004690</td>
      <td>삼천리</td>
      <td>10.150234</td>
      <td>0.233540</td>
      <td>3.238360</td>
      <td>0.101066</td>
    </tr>
    <tr>
      <th>14</th>
      <td>001940</td>
      <td>KISCO홀딩스</td>
      <td>9.318522</td>
      <td>0.240852</td>
      <td>2.251324</td>
      <td>0.301981</td>
    </tr>
    <tr>
      <th>15</th>
      <td>017940</td>
      <td>E1</td>
      <td>5.278673</td>
      <td>0.255974</td>
      <td>1.817841</td>
      <td>0.081043</td>
    </tr>
    <tr>
      <th>16</th>
      <td>013580</td>
      <td>계룡건설</td>
      <td>3.155714</td>
      <td>0.490021</td>
      <td>1.532263</td>
      <td>0.134978</td>
    </tr>
    <tr>
      <th>17</th>
      <td>036530</td>
      <td>SNT홀딩스</td>
      <td>8.042960</td>
      <td>0.185970</td>
      <td>1.151193</td>
      <td>0.209505</td>
    </tr>
    <tr>
      <th>18</th>
      <td>004960</td>
      <td>한신공영</td>
      <td>2.622255</td>
      <td>0.447321</td>
      <td>1.310509</td>
      <td>0.178365</td>
    </tr>
    <tr>
      <th>19</th>
      <td>002030</td>
      <td>아세아</td>
      <td>6.573072</td>
      <td>0.180721</td>
      <td>1.449181</td>
      <td>0.180780</td>
    </tr>
    <tr>
      <th>20</th>
      <td>092230</td>
      <td>KPX홀딩스</td>
      <td>1.942435</td>
      <td>0.204169</td>
      <td>3.045894</td>
      <td>0.286312</td>
    </tr>
    <tr>
      <th>21</th>
      <td>033160</td>
      <td>엠케이전자</td>
      <td>9.408010</td>
      <td>0.283942</td>
      <td>0.788508</td>
      <td>0.297559</td>
    </tr>
    <tr>
      <th>22</th>
      <td>003030</td>
      <td>세아제강지주</td>
      <td>14.168827</td>
      <td>0.182075</td>
      <td>0.901365</td>
      <td>0.105050</td>
    </tr>
    <tr>
      <th>23</th>
      <td>003960</td>
      <td>사조대림</td>
      <td>5.097396</td>
      <td>0.381515</td>
      <td>2.098562</td>
      <td>0.100281</td>
    </tr>
    <tr>
      <th>24</th>
      <td>005740</td>
      <td>크라운해태홀딩스</td>
      <td>7.294002</td>
      <td>0.342912</td>
      <td>2.194910</td>
      <td>0.180928</td>
    </tr>
    <tr>
      <th>25</th>
      <td>002460</td>
      <td>화성산업</td>
      <td>4.856562</td>
      <td>0.408714</td>
      <td>1.604357</td>
      <td>0.384541</td>
    </tr>
    <tr>
      <th>26</th>
      <td>006980</td>
      <td>우성사료</td>
      <td>2.176319</td>
      <td>0.071154</td>
      <td>0.928136</td>
      <td>0.032482</td>
    </tr>
    <tr>
      <th>27</th>
      <td>036710</td>
      <td>심텍홀딩스</td>
      <td>4.848350</td>
      <td>0.354757</td>
      <td>0.534644</td>
      <td>0.094409</td>
    </tr>
    <tr>
      <th>28</th>
      <td>016250</td>
      <td>SGC이테크건설</td>
      <td>0.632288</td>
      <td>0.802643</td>
      <td>1.652076</td>
      <td>0.097309</td>
    </tr>
    <tr>
      <th>29</th>
      <td>010100</td>
      <td>한국프랜지</td>
      <td>8.649494</td>
      <td>0.423351</td>
      <td>1.726921</td>
      <td>0.113809</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="simple">
<li><p>행 방향으로 종목별 랭킹들의 합을 구해주며, skipna = False를 통해 NA가 있는 종목은 제외합니다.</p></li>
<li><p>네 개 지표 랭킹의 합 기준 랭킹이 낮은 30종목을 선택합니다. 즉 하나의 지표보다 네 개 지표가 골고루 낮은 종목을 선택합니다.</p></li>
<li><p>해당 종목들의 티커, 종목명과 가치지표를 묶어줍니다.</p></li>
</ol>
</div>
</div>
<div class="section" id="id19">
<h2>12.5 퀄리티 전략<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h2>
<p>벤자민 그레이엄 이후 유지되고 있는 기본적 분석 혹은 가치 투자자들의 가장 중요한 투자 지표 중 하나는 기업의 우량성입니다. 벤저민 그레이엄은 종목 선정에 있어 유동 자산이
풍부하여 재무적으로 건전하고, 꾸준하게 이익을 달성하는 기업을 강조했습니다. 최고의 투자자로 꼽히는 워런 버핏의 종목 선정 기준 역시 실적의 강력한 성장 추세와 높은 자기자본 이익률로 알려져 있습니다.</p>
<p>연구에 따르면 기업의 우량성이 높은 종목의 수익률이 상승하는 경향이 있으며, 이는 주가가 해당 기업의 이익을 충분히 반영하지 못하는 경향이 있기 때문입니다(Sloan 1996). 퀄리티 전략은 우량성이 우수한 종목을 선택하는 것이며, 주로 재무제표 데이터가 사용됩니다.</p>
<div class="section" id="f-score">
<h3>12.5.1 F-Score<a class="headerlink" href="#f-score" title="Permalink to this headline">¶</a></h3>
<p>F-Score 지표는 조셉 피오트로스키 교수가 발표(Piotroski and others 2000)한 지표입니다. 그는 논문에서, 저PBR을 이용한 밸류 전략은 높은 성과를 기록하지만 재무 상태가 불량한 기업이 많으며, 저PBR 종목 중 재무적으로 우량한 기업을 선정해 투자한다면 성과를 훨씬 개선할 수 있다고 보았습니다.</p>
<p>F-Score에서는 재무적 우량 정도를 수익성(Profitability), 재무 성과(Financial Performance), 운영 효율성(Operating Efficiency)으로 구분해 총 9개의 지표를 선정합니다. <a class="reference internal" href="#id20"><span class="std std-numref">Table 10</span></a>는 이를 요약한 테이블입니다.</p>
<table class="colwidths-auto table" id="id20">
<caption><span class="caption-number">Table 10 </span><span class="caption-text">F-Score 요약</span><a class="headerlink" href="#id20" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>지표</p></th>
<th class="head"><p>항목</p></th>
<th class="head"><p>점수</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>수익성</p></td>
<td><p>ROA</p></td>
<td><p>ROA가 양수면 1점</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>CFO</p></td>
<td><p>CFO가 양수면 1점</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>ΔROA</p></td>
<td><p>ROA가 증가했으면 1점</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>ACCRUAL</p></td>
<td><p>CFO &gt; ROA면 1점</p></td>
</tr>
<tr class="row-even"><td><p>재무 성과</p></td>
<td><p>Δ Lever</p></td>
<td><p>레버리지가 감소했으면 1점</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Δ LIQUID</p></td>
<td><p>유동성이 증가했으면 1점</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>EQ_OFFER</p></td>
<td><p>발행주식수가 감소했으면 1점</p></td>
</tr>
<tr class="row-odd"><td><p>운영 효율성</p></td>
<td><p>Δ MARGIN</p></td>
<td><p>매출총이익률이 증가했으면 1점</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Δ TURN</p></td>
<td><p>회전율이 증가했으면 1점</p></td>
</tr>
</tbody>
</table>
<p>각 지표가 우수할 경우 1점, 그렇지 않을 경우 0점을 매겨, 총 0점부터 9점까지의 포트폴리오를 구성합니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">KOR_ticker</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/KOR_ticker.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">KOR_ticker</span><span class="p">[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KOR_ticker</span><span class="p">[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>    

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/KOR_fs.pickle&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">KOR_fs</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>먼저 티커와 재무제표 파일을 불러옵니다. 재무제표 데이터는 피클 파일로 저장되어 있으며, <code class="docutils literal notranslate"><span class="pre">pickle.load()</span></code> 함수를 이용해 딕셔너리 형태 그대로 불러올 수 있습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 수익성</span>
<span class="n">ROA</span> <span class="o">=</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;지배주주순이익&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;자산&#39;</span><span class="p">]</span>
<span class="n">CFO</span> <span class="o">=</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;영업활동으로인한현금흐름&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;자산&#39;</span><span class="p">]</span>
<span class="n">ACCURUAL</span> <span class="o">=</span> <span class="n">CFO</span> <span class="o">-</span> <span class="n">ROA</span>

<span class="c1"># 재무성과</span>
<span class="n">LEV</span> <span class="o">=</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;장기차입금&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;자산&#39;</span><span class="p">]</span>
<span class="n">LIQ</span> <span class="o">=</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;유동자산&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;유동부채&#39;</span><span class="p">]</span>
<span class="n">OFFER</span> <span class="o">=</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;유상증자&#39;</span><span class="p">]</span>

<span class="c1"># 운영 효율성</span>
<span class="n">MARGIN</span> <span class="o">=</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;매출총이익&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;매출액&#39;</span><span class="p">]</span>
<span class="n">TURN</span> <span class="o">=</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;매출액&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;자산&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>지표에 해당하는 내용을 계산해줍니다.</p>
<ol class="simple">
<li><p>ROA는 지배주주순이익을 자산으로 나누어 계산합니다.</p></li>
<li><p>CFO는 영업활동현금흐름을 자산으로 나누어 계산합니다.</p></li>
<li><p>ACCURUAL은 CFO와 ROA의 차이를 이용해 계산합니다.</p></li>
<li><p>LEV(Leverage)는 장기차입금을 자산으로 나누어 계산합니다.</p></li>
<li><p>LIQ(Liquidity)는 유동자산을 유동부채로 나누어 계산합니다.</p></li>
<li><p>우리가 받은 데이터에서는 발행주식수 데이터를 구할 수 없으므로, OFFER에 대한 대용치로 유상증자 여부를 사용합니다.</p></li>
<li><p>MARGIN은 매출총이익을 매출액으로 나누어 계산합니다.</p></li>
<li><p>TURN(Turnover)은 매출액을 자산으로 나누어 계산합니다.</p></li>
<li><p>다음으로 각 지표들이 조건을 충족하는지 여부를 판단해, 지표별로 1점 혹은 0점을 부여합니다.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>

<span class="k">if</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">month</span> <span class="ow">in</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">num_col</span> <span class="o">=</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;매출액&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">num_col</span> <span class="o">=</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;매출액&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ROA</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">num_col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">*</span> <span class="mi">1</span>
<span class="n">F_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">CFO</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">num_col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">*</span> <span class="mi">1</span>
<span class="n">F_3</span> <span class="o">=</span> <span class="p">((</span><span class="n">ROA</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">num_col</span><span class="p">]</span>  <span class="o">-</span> <span class="n">ROA</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">(</span><span class="n">num_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span>
<span class="n">F_4</span> <span class="o">=</span> <span class="p">(</span><span class="n">ACCURUAL</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">num_col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">*</span> <span class="mi">1</span>
<span class="n">F_5</span> <span class="o">=</span> <span class="p">((</span><span class="n">LEV</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">num_col</span><span class="p">]</span>  <span class="o">-</span> <span class="n">LEV</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">(</span><span class="n">num_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span>
<span class="n">F_6</span> <span class="o">=</span> <span class="p">((</span><span class="n">LIQ</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">num_col</span><span class="p">]</span>  <span class="o">-</span> <span class="n">LIQ</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">(</span><span class="n">num_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span>
<span class="n">F_7</span> <span class="o">=</span> <span class="p">((</span><span class="n">OFFER</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">num_col</span><span class="p">])</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">|</span> <span class="p">(</span><span class="n">OFFER</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">num_col</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">))</span> <span class="o">*</span> <span class="mi">1</span>
<span class="n">F_8</span> <span class="o">=</span> <span class="p">((</span><span class="n">MARGIN</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">num_col</span><span class="p">]</span>  <span class="o">-</span> <span class="n">MARGIN</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">(</span><span class="n">num_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span>
<span class="n">F_9</span> <span class="o">=</span> <span class="p">((</span><span class="n">TURN</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">num_col</span><span class="p">]</span>  <span class="o">-</span> <span class="n">TURN</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">(</span><span class="n">num_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>num_col 변수에 원하는 열의 위치를 구해줍니다. 1월~3월에 데이터를 받을 경우 일부 종목에서만 전년도 재무제표가 들어오는 경향이 있으므로, 전전년도 데이터를 사용해야 합니다. (4월 초반에도 전년도 재무제표가 완벽하게 들어오지 않을 수 있으므로 주의해야 합니다.) 따라서 <code class="docutils literal notranslate"><span class="pre">date.today().month</span></code>를 통해 현재 날짜가 1월~3월인 경우 열 이름이 2년전 년도를 포함하는 부분을(예: 만일 오늘이 2021년 1월 이라면 열 이름중 2019가 포함된 곳), 그렇지 않을 경우(4~12월) 열 이름이 1년전 년도를 포함하는 부분을(예: 만일 오늘이 2021년 5월 이라면 열 이름중 2020가 포함된 곳) 선택합니다.</p>
<p>다음으로 F-Score의 각 지표에 해당하는 점수를 매기며, 그 기준은 다음과 같습니다.</p>
<ol class="simple">
<li><p>ROA가 양수면 1점, 그렇지 않으면 0점</p></li>
<li><p>영업활동현금흐름이 양수면 1점, 그렇지 않으면 0점</p></li>
<li><p>최근 ROA가 전년 대비 증가했으면ROA[, num_col] &gt; 0 1점, 그렇지 않으면 0점</p></li>
<li><p>ACCURUAL(CFO - ROA)이 양수면 1점, 그렇지 않으면 0점</p></li>
<li><p>레버리지가 전년 대비 감소했으면 1점, 그렇지 않으면 0점</p></li>
<li><p>유동성이 전년 대비 증가했으면 1점, 그렇지 않으면 0점</p></li>
<li><p>유상증자 항목이 없거나 0이면 1점, 그렇지 않으면 0점</p></li>
<li><p>매출총이익률이 전년 대비 증가했으면 1점, 그렇지 않으면 0점</p></li>
<li><p>회전율이 전년 대비 증가했으면 1점, 그렇지 않으면 0점</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_Table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">F_1</span><span class="p">,</span> <span class="n">F_2</span><span class="p">,</span> <span class="n">F_3</span><span class="p">,</span> <span class="n">F_4</span><span class="p">,</span> <span class="n">F_5</span><span class="p">,</span> <span class="n">F_6</span><span class="p">,</span> <span class="n">F_7</span><span class="p">,</span> <span class="n">F_8</span><span class="p">,</span> <span class="n">F_9</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">F_Score</span> <span class="o">=</span> <span class="n">F_Table</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">F_count</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">F_Score</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">F_count</span> <span class="o">/</span> <span class="n">F_count</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    0.004098
1    0.045993
2    0.094262
3    0.143898
4    0.186703
5    0.191257
6    0.156193
7    0.102004
8    0.065118
9    0.010474
dtype: float64
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>각 점수를 열의 형태로 묶어줍니다.</p></li>
<li><p>종목 별 점수를 더해 F-Score를 계산합니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">value_counts()</span></code> 함수를 통해 F-Score별 빈도를 계산합니다.</p></li>
<li><p>합계로 나누어 비중을 계산합니다.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">height</span> <span class="o">=</span> <span class="n">F_count</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/12_factor_basic_131_0.png" src="_images/12_factor_basic_131_0.png" />
</div>
</div>
<p>점수별 비중을 살펴보면 3-6점에 상당히 많은 종목이 분포하고 있음이 확인됩니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">invest_F_Score</span> <span class="o">=</span> <span class="p">(</span><span class="n">F_Score</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span>

<span class="n">invest_F_df</span> <span class="o">=</span> <span class="n">KOR_ticker</span><span class="p">[</span><span class="n">invest_F_Score</span><span class="o">.</span><span class="n">values</span><span class="p">][[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">,</span> <span class="s1">&#39;종목명&#39;</span><span class="p">]]</span>
<span class="n">invest_F_df</span><span class="p">[</span><span class="s1">&#39;F-Score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">F_Score</span><span class="p">[</span><span class="n">invest_F_Score</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">invest_F_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목코드</th>
      <th>종목명</th>
      <th>F-Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>000660</td>
      <td>SK하이닉스</td>
      <td>9</td>
    </tr>
    <tr>
      <th>38</th>
      <td>009830</td>
      <td>한화솔루션</td>
      <td>9</td>
    </tr>
    <tr>
      <th>62</th>
      <td>021240</td>
      <td>코웨이</td>
      <td>9</td>
    </tr>
    <tr>
      <th>64</th>
      <td>011070</td>
      <td>LG이노텍</td>
      <td>9</td>
    </tr>
    <tr>
      <th>123</th>
      <td>000080</td>
      <td>하이트진로</td>
      <td>9</td>
    </tr>
    <tr>
      <th>276</th>
      <td>103140</td>
      <td>풍산</td>
      <td>9</td>
    </tr>
    <tr>
      <th>412</th>
      <td>195870</td>
      <td>해성디에스</td>
      <td>9</td>
    </tr>
    <tr>
      <th>576</th>
      <td>000140</td>
      <td>하이트진로홀딩스</td>
      <td>9</td>
    </tr>
    <tr>
      <th>668</th>
      <td>001790</td>
      <td>대한제당</td>
      <td>9</td>
    </tr>
    <tr>
      <th>711</th>
      <td>067900</td>
      <td>와이엔텍</td>
      <td>9</td>
    </tr>
    <tr>
      <th>721</th>
      <td>017890</td>
      <td>한국알콜</td>
      <td>9</td>
    </tr>
    <tr>
      <th>859</th>
      <td>004140</td>
      <td>동방</td>
      <td>9</td>
    </tr>
    <tr>
      <th>954</th>
      <td>001070</td>
      <td>대한방직</td>
      <td>9</td>
    </tr>
    <tr>
      <th>987</th>
      <td>003100</td>
      <td>선광</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1044</th>
      <td>091580</td>
      <td>상신이디피</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1121</th>
      <td>033320</td>
      <td>제이씨현시스템</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1273</th>
      <td>019770</td>
      <td>서연탑메탈</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1300</th>
      <td>253590</td>
      <td>네오셈</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1586</th>
      <td>003720</td>
      <td>삼영화학</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1646</th>
      <td>049800</td>
      <td>우진플라임</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1697</th>
      <td>021650</td>
      <td>한국큐빅</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1940</th>
      <td>311390</td>
      <td>네오크레마</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>069140</td>
      <td>누리플랜</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>F-Score가 9점인 종목의 티커와 종목명을 확인해봅니다. 이는 재무적으로 매우 우량하다고 판단되는 종목입니다.</p>
</div>
<div class="section" id="id21">
<h3>12.5.2 수익성 지표 결합하기<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<p>퀄리티는 투자자들이 매우 중요하게 생각하는 요소입니다. 그러나 어떠한 지표가 기업의 퀄리티를 나타내는지 한 마디로 정의하기에는 너무나 주관적이고 광범위해 쉽지 않습니다. 애스니스는 연구를 통해(Asness et al. 2019) 수익성, 성장성, 안정성이 높을 주식일수록 수익률이 높은 경향이 있음을 보였습니다.</p>
<p>이 외에도 학계 혹은 업계에서 사용되는 우량성 관련 지표는 다음과 같이 요약할 수 있습니다. (Hsu, Kalesnik, and Kose 2019)</p>
<ol class="simple">
<li><p>Profitability (수익성)</p></li>
<li><p>Earnings stability (수익의 안정성)</p></li>
<li><p>Capital structure (기업 구조)</p></li>
<li><p>Growth (수익의 성장성)</p></li>
<li><p>Accounting quality (회계적 우량성)</p></li>
<li><p>Payout/dilution (배당)</p></li>
<li><p>Investment (투자)</p></li>
</ol>
<p>이 중 연구에 따르면 수익성이 수익률과 가장 연관성이 높은 것으로 나타납니다. 수익성 지표에는 전통적으로 자기자본이익률(ROE)가 사용되지만 그 외에 매출총이익(Novy Marx 2013), 영업활동현금흐름(Bouchaud et al. 2016) 등이 사용됩니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">if</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">month</span> <span class="ow">in</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">num_col</span> <span class="o">=</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;매출액&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">num_col</span> <span class="o">=</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;매출액&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    
<span class="n">q_roe</span> <span class="o">=</span> <span class="p">(</span><span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;지배주주순이익&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;자본&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">num_col</span><span class="p">]</span>
<span class="n">q_gpa</span> <span class="o">=</span> <span class="p">(</span><span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;매출총이익&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;자산&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">num_col</span><span class="p">]</span>
<span class="n">q_cfo</span> <span class="o">=</span> <span class="p">(</span><span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;영업활동으로인한현금흐름&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">KOR_fs</span><span class="p">[</span><span class="s1">&#39;자산&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">num_col</span><span class="p">]</span>

<span class="n">q_profit</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">q_roe</span><span class="p">,</span> <span class="n">q_gpa</span><span class="p">,</span> <span class="n">q_cfo</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">q_profit</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ROE&#39;</span><span class="p">,</span> <span class="s1">&#39;GPA&#39;</span><span class="p">,</span> <span class="s1">&#39;CFO&#39;</span><span class="p">]</span>    
</pre></div>
</div>
</div>
</div>
<p>먼저 세 가지 지표에 해당하는 값을 계산한 후, 최근년도 데이터만 선택합니다. 1~3월의 경우 전년도가 아닌 전전년도 회계 데이터를 사용합니다. 그 후 <code class="docutils literal notranslate"><span class="pre">concat()</span></code> 함수를 이용해 지표들을 하나로 묶어줍니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">rank_quality</span>  <span class="o">=</span> <span class="n">q_profit</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">rank_quality</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ROE</th>
      <th>GPA</th>
      <th>CFO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ROE</th>
      <td>1.0000</td>
      <td>0.4547</td>
      <td>0.5052</td>
    </tr>
    <tr>
      <th>GPA</th>
      <td>0.4547</td>
      <td>1.0000</td>
      <td>0.4540</td>
    </tr>
    <tr>
      <th>CFO</th>
      <td>0.5052</td>
      <td>0.4540</td>
      <td>1.0000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">rank()</span></code> 함수를 통해 지표별 랭킹을 구하며, 퀄리티 지표는 높을수록 좋은 내림차순으로 계산해야 하므로 <code class="docutils literal notranslate"><span class="pre">ascending</span> <span class="pre">=</span> <span class="pre">False</span></code>를 입력합니다. 수익성 지표 역시 서로 간의 상관관계가 낮아, 지표를 통합적으로 고려 시 분산효과를 기대할 수 있습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q_rank_sum</span> <span class="o">=</span> <span class="n">rank_quality</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">invest_quality</span>  <span class="o">=</span> <span class="p">(</span><span class="n">q_rank_sum</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">invest_quality_df</span> <span class="o">=</span> <span class="n">KOR_ticker</span><span class="p">[</span><span class="n">invest_quality</span><span class="p">][[</span><span class="s1">&#39;종목코드&#39;</span><span class="p">,</span> <span class="s1">&#39;종목명&#39;</span><span class="p">]]</span>
 
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">invest_quality_df</span><span class="p">,</span> <span class="n">q_profit</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">invest_quality</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;종목코드&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목코드</th>
      <th>종목명</th>
      <th>ROE</th>
      <th>GPA</th>
      <th>CFO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>021240</td>
      <td>코웨이</td>
      <td>0.271745</td>
      <td>0.724166</td>
      <td>0.185804</td>
    </tr>
    <tr>
      <th>1</th>
      <td>096530</td>
      <td>씨젠</td>
      <td>0.777073</td>
      <td>0.783574</td>
      <td>0.350082</td>
    </tr>
    <tr>
      <th>2</th>
      <td>069080</td>
      <td>웹젠</td>
      <td>0.198298</td>
      <td>0.541920</td>
      <td>0.249493</td>
    </tr>
    <tr>
      <th>3</th>
      <td>030190</td>
      <td>NICE평가정보</td>
      <td>0.182380</td>
      <td>1.209328</td>
      <td>0.202820</td>
    </tr>
    <tr>
      <th>4</th>
      <td>067160</td>
      <td>아프리카TV</td>
      <td>0.247967</td>
      <td>0.673288</td>
      <td>0.247603</td>
    </tr>
    <tr>
      <th>5</th>
      <td>214150</td>
      <td>클래시스</td>
      <td>0.308562</td>
      <td>0.443636</td>
      <td>0.277091</td>
    </tr>
    <tr>
      <th>6</th>
      <td>230360</td>
      <td>에코마케팅</td>
      <td>0.354990</td>
      <td>0.907692</td>
      <td>0.262051</td>
    </tr>
    <tr>
      <th>7</th>
      <td>139670</td>
      <td>키네마스터</td>
      <td>0.174825</td>
      <td>1.806061</td>
      <td>0.218182</td>
    </tr>
    <tr>
      <th>8</th>
      <td>348210</td>
      <td>넥스틴</td>
      <td>0.320261</td>
      <td>0.550645</td>
      <td>0.184162</td>
    </tr>
    <tr>
      <th>9</th>
      <td>215000</td>
      <td>골프존</td>
      <td>0.169770</td>
      <td>0.508032</td>
      <td>0.237953</td>
    </tr>
    <tr>
      <th>10</th>
      <td>206640</td>
      <td>바디텍메드</td>
      <td>0.360825</td>
      <td>0.597554</td>
      <td>0.272783</td>
    </tr>
    <tr>
      <th>11</th>
      <td>263720</td>
      <td>디앤씨미디어</td>
      <td>0.209615</td>
      <td>0.905808</td>
      <td>0.194662</td>
    </tr>
    <tr>
      <th>12</th>
      <td>064550</td>
      <td>바이오니아</td>
      <td>0.391216</td>
      <td>0.850418</td>
      <td>0.500523</td>
    </tr>
    <tr>
      <th>13</th>
      <td>285490</td>
      <td>노바텍</td>
      <td>0.260664</td>
      <td>0.395934</td>
      <td>0.279768</td>
    </tr>
    <tr>
      <th>14</th>
      <td>298540</td>
      <td>더네이쳐홀딩스</td>
      <td>0.245294</td>
      <td>0.765957</td>
      <td>0.168665</td>
    </tr>
    <tr>
      <th>15</th>
      <td>034950</td>
      <td>한국기업평가</td>
      <td>0.178094</td>
      <td>0.636786</td>
      <td>0.202523</td>
    </tr>
    <tr>
      <th>16</th>
      <td>205470</td>
      <td>휴마시스</td>
      <td>0.429158</td>
      <td>0.453079</td>
      <td>0.209677</td>
    </tr>
    <tr>
      <th>17</th>
      <td>192440</td>
      <td>슈피겐코리아</td>
      <td>0.158519</td>
      <td>0.675382</td>
      <td>0.197583</td>
    </tr>
    <tr>
      <th>18</th>
      <td>220630</td>
      <td>해마로푸드서비스</td>
      <td>0.304738</td>
      <td>0.740582</td>
      <td>0.247432</td>
    </tr>
    <tr>
      <th>19</th>
      <td>110790</td>
      <td>크리스에프앤씨</td>
      <td>0.161116</td>
      <td>0.624681</td>
      <td>0.198342</td>
    </tr>
    <tr>
      <th>20</th>
      <td>287410</td>
      <td>제이시스메디칼</td>
      <td>0.305882</td>
      <td>0.903061</td>
      <td>0.410714</td>
    </tr>
    <tr>
      <th>21</th>
      <td>051160</td>
      <td>지어소프트</td>
      <td>0.337719</td>
      <td>0.639252</td>
      <td>0.238318</td>
    </tr>
    <tr>
      <th>22</th>
      <td>207760</td>
      <td>미스터블루</td>
      <td>0.228464</td>
      <td>1.147937</td>
      <td>0.260313</td>
    </tr>
    <tr>
      <th>23</th>
      <td>084650</td>
      <td>랩지노믹스</td>
      <td>0.524510</td>
      <td>0.655393</td>
      <td>0.424132</td>
    </tr>
    <tr>
      <th>24</th>
      <td>092130</td>
      <td>이크레더블</td>
      <td>0.226252</td>
      <td>0.635556</td>
      <td>0.253333</td>
    </tr>
    <tr>
      <th>25</th>
      <td>352700</td>
      <td>씨앤투스성진</td>
      <td>0.437330</td>
      <td>0.700806</td>
      <td>0.603226</td>
    </tr>
    <tr>
      <th>26</th>
      <td>058630</td>
      <td>엠게임</td>
      <td>0.146552</td>
      <td>0.743860</td>
      <td>0.217544</td>
    </tr>
    <tr>
      <th>27</th>
      <td>036120</td>
      <td>SCI평가정보</td>
      <td>0.218310</td>
      <td>1.413889</td>
      <td>0.252778</td>
    </tr>
    <tr>
      <th>28</th>
      <td>130580</td>
      <td>나이스디앤비</td>
      <td>0.156204</td>
      <td>0.941581</td>
      <td>0.210767</td>
    </tr>
    <tr>
      <th>29</th>
      <td>238490</td>
      <td>힘스</td>
      <td>0.221364</td>
      <td>0.502750</td>
      <td>0.361936</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>세 개 지표 랭킹의 합 기준 랭킹이 낮은 30종목을 선택합니다. 즉 세 가지 수익 지표가 골고루 높은 종목을 선택합니다. 해당 종목들의 티커, 종목명, ROE, GPA, CFO을 출력해 확인합니다.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="11_data_analysis.html" title="previous page">11. 데이터 분석 및 시각화하기</a>
    <a class='right-next' id="next-link" href="13_factor_advanced.html" title="next page">13. 퀀트 전략을 이용한 종목선정 (심화)</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By 이현열<br/>
        
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>